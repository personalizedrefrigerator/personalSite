(()=>{var e={408:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(81),i=n.n(r),o=n(645),s=n.n(o)()(i());s.push([t.id,"\n:root {\n\t/* Deafult colors for the editor */\n    --primary-background-color: white;\n    --primary-background-color-transparent: rgba(255, 255, 255, 0.5);\n    --secondary-background-color: #faf;\n    --primary-foreground-color: black;\n    --secondary-foreground-color: black;\n}\n\nbody {\n\tcolor: var(--primary-foreground-color);\n\tfont-family: system-ui, -apple-system, sans-serif;\n\tbackground-color: var(--primary-background-color);\n}\n\ncanvas {\n\tposition: fixed;\n\tleft: 0;\n\tright: 0;\n\ttop: 0;\n\tbottom: 0;\n\twidth: 100vw;\n\theight: 100vh;\n\ttouch-action: none;\n}\n\n.loadingMessage {\n\tposition: fixed;\n\ttext-align: center;\n\tfont-size: 2em;\n\n\tbottom: 0;\n\tleft: 0;\n\tright: 0;\n}\n",""]);const a=s},872:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(81),i=n.n(r),o=n(645),s=n.n(o)()(i());s.push([t.id,".toolbar-root {\n    background-color: var(--primary-background-color);\n\n    border: 1px solid var(--secondary-background-color);\n    border-radius: 2px;\n    flex-wrap: wrap;\n\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n\n    font-family: system-ui, -apple-system, sans-serif;\n}\n\n.toolbar-button, .toolbar-root button {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n\n    text-align: center;\n    border-radius: 6px;\n    cursor: pointer;\n\n    padding-left: 3px;\n    padding-right: 3px;\n    margin-left: 3px;\n    margin-right: 3px;\n\n    min-width: 40px;\n    max-width: 70px;\n    font-size: 11pt;\n\n    cursor: pointer;\n\n    height: min(20vh, 60px);\n    background-color: var(--primary-background-color);\n    color: var(--primary-foreground-color);\n    border: none;\n    box-shadow: 0px 0px 2px var(--primary-foreground-color);\n\n    transition: background-color 0.25s ease, box-shadow 0.25s ease, opacity 0.3s ease;\n}\n\n.toolbar-button:hover, .toolbar-root button:not(:disabled):hover {\n    box-shadow: 0px 2px 4px var(--primary-foreground-color);\n}\n\n.toolbar-root button {\n    height: auto;\n}\n\n.toolbar-root button:disabled {\n    cursor: inherit;\n    filter: opacity(0.5);\n}\n\n.toolbar-button .toolbar-icon {\n    flex-shrink: 1;\n    min-width: 30px;\n}\n\n.toolbar-toolContainer.selected .toolbar-button {\n    background-color: var(--secondary-background-color);\n    color: var(--secondary-foreground-color);\n}\n\n.toolbar-toolContainer:not(.selected) .toolbar-showHideDropdownIcon {\n    display: none;\n}\n\n.toolbar-toolContainer.selected .toolbar-showHideDropdownIcon {\n    height: 10px;\n    transition: transform 0.5s ease;\n}\n\n.toolbar-toolContainer.dropdownVisible .toolbar-showHideDropdownIcon {\n    transform: rotate(180deg);\n}\n\n.toolbar-dropdown.hidden, .toolbar-toolContainer:not(.selected) > .toolbar-dropdown {\n    display: none;\n}\n\n.toolbar-dropdown {\n    position: absolute;\n    padding: 15px;\n    padding-top: 5px;\n    /* Prevent overlap/being displayed under the undo/redo buttons */\n    z-index: 2;\n    background-color: var(--primary-background-color);\n    box-shadow: 0px 3px 3px var(--primary-foreground-color);\n}\n\n.toolbar-buttonGroup {\n    display: flex;\n    flex-direction: row;\n}\n\n/* Make color selection buttons fill their containing label */\n.toolbar-dropdown .clr-field button {\n    width: 100%;\n    height: 100%;\n    border-radius: 2px;\n    margin-left: 0;\n    margin-right: 0;\n}\n",""]);const a=s},786:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(81),i=n.n(r),o=n(645),s=n.n(o)()(i());s.push([t.id,'.clr-picker {\r\n  display: none;\r\n  flex-wrap: wrap;\r\n  position: absolute;\r\n  width: 200px;\r\n  z-index: 1000;\r\n  border-radius: 10px;\r\n  background-color: #fff;\r\n  justify-content: space-between;\r\n  box-shadow: 0 0 5px rgba(0,0,0,.05), 0 5px 20px rgba(0,0,0,.1);\r\n  -moz-user-select: none;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n}\r\n\r\n.clr-picker.clr-open,\r\n.clr-picker[data-inline="true"] {\r\n  display: flex;\r\n}\r\n\r\n.clr-picker[data-inline="true"] {\r\n  position: relative;\r\n}\r\n\r\n.clr-gradient {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100px;\r\n  margin-bottom: 15px;\r\n  border-radius: 3px 3px 0 0;\r\n  background-image: linear-gradient(rgba(0,0,0,0), #000), linear-gradient(90deg, #fff, currentColor);\r\n  cursor: pointer;\r\n}\r\n\r\n.clr-marker {\r\n  position: absolute;\r\n  width: 12px;\r\n  height: 12px;\r\n  margin: -6px 0 0 -6px;\r\n  border: 1px solid #fff;\r\n  border-radius: 50%;\r\n  background-color: currentColor;\r\n  cursor: pointer;\r\n}\r\n\r\n.clr-picker input[type="range"]::-webkit-slider-runnable-track {\r\n  width: 100%;\r\n  height: 8px;\r\n}\r\n\r\n.clr-picker input[type="range"]::-webkit-slider-thumb {\r\n  width: 8px;\r\n  height: 8px;\r\n  -webkit-appearance: none;\r\n}\r\n\r\n.clr-picker input[type="range"]::-moz-range-track {\r\n  width: 100%;\r\n  height: 8px;\r\n  border: 0;\r\n}\r\n\r\n.clr-picker input[type="range"]::-moz-range-thumb {\r\n  width: 8px;\r\n  height: 8px;\r\n  border: 0;\r\n}\r\n\r\n.clr-hue {\r\n  background-image: linear-gradient(to right, #f00 0%, #ff0 16.66%, #0f0 33.33%, #0ff 50%, #00f 66.66%, #f0f 83.33%, #f00 100%);\r\n}\r\n\r\n.clr-hue,\r\n.clr-alpha {\r\n  position: relative;\r\n  width: calc(100% - 40px);\r\n  height: 8px;\r\n  margin: 5px 20px;\r\n  border-radius: 4px;\r\n}\r\n\r\n.clr-alpha span {\r\n  display: block;\r\n  height: 100%;\r\n  width: 100%;\r\n  border-radius: inherit;\r\n  background-image: linear-gradient(90deg, rgba(0,0,0,0), currentColor);\r\n}\r\n\r\n.clr-hue input,\r\n.clr-alpha input {\r\n  position: absolute;\r\n  width: calc(100% + 16px);\r\n  height: 16px;\r\n  left: -8px;\r\n  top: -4px;\r\n  margin: 0;\r\n  background-color: transparent;\r\n  opacity: 0;\r\n  cursor: pointer;\r\n  appearance: none;\r\n  -webkit-appearance: none;\r\n}\r\n\r\n.clr-hue div,\r\n.clr-alpha div {\r\n  position: absolute;\r\n  width: 16px;\r\n  height: 16px;\r\n  left: 0;\r\n  top: 50%;\r\n  margin-left: -8px;\r\n  transform: translateY(-50%);\r\n  border: 2px solid #fff;\r\n  border-radius: 50%;\r\n  background-color: currentColor;\r\n  box-shadow: 0 0 1px #888;\r\n  pointer-events: none;\r\n}\r\n\r\n.clr-alpha div:before {\r\n  content: \'\';\r\n  position: absolute;\r\n  height: 100%;\r\n  width: 100%;\r\n  left: 0;\r\n  top: 0;\r\n  border-radius: 50%;\r\n  background-color: currentColor;\r\n}\r\n\r\n.clr-format {\r\n  display: none;\r\n  order: 1;\r\n  width: calc(100% - 40px);\r\n  margin: 0 20px 20px;\r\n}\r\n\r\n.clr-segmented {\r\n  display: flex;\r\n  position: relative;\r\n  width: 100%;\r\n  margin: 0;\r\n  padding: 0;\r\n  border: 1px solid #ddd;\r\n  border-radius: 15px;\r\n  box-sizing: border-box;\r\n  color: #999;\r\n  font-size: 12px;\r\n}\r\n\r\n.clr-segmented input,\r\n.clr-segmented legend {\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 100%;\r\n  margin: 0;\r\n  padding: 0;\r\n  border: 0;\r\n  left: 0;\r\n  top: 0;\r\n  opacity: 0;\r\n  pointer-events: none;\r\n}\r\n\r\n.clr-segmented label {\r\n  flex-grow: 1;\r\n  padding: 4px 0;\r\n  text-align: center;\r\n  cursor: pointer;\r\n}\r\n\r\n.clr-segmented label:first-of-type {\r\n  border-radius: 10px 0 0 10px;\r\n}\r\n\r\n.clr-segmented label:last-of-type {\r\n  border-radius: 0 10px 10px 0;\r\n}\r\n\r\n.clr-segmented input:checked + label {\r\n  color: #fff;\r\n  background-color: #666;\r\n}\r\n\r\n.clr-swatches {\r\n  order: 2;\r\n  width: calc(100% - 32px);\r\n  margin: 0 16px;\r\n}\r\n\r\n.clr-swatches div {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  padding-bottom: 12px;\r\n  justify-content: center;\r\n}\r\n\r\n.clr-swatches button {\r\n  position: relative;\r\n  width: 20px;\r\n  height: 20px;\r\n  margin: 0 4px 6px 4px;\r\n  border: 0;\r\n  border-radius: 50%;\r\n  color: inherit;\r\n  text-indent: -1000px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n}\r\n\r\n.clr-swatches button:after {\r\n  content: \'\';\r\n  display: block;\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 100%;\r\n  left: 0;\r\n  top: 0;\r\n  border-radius: inherit;\r\n  background-color: currentColor;\r\n  box-shadow: inset 0 0 0 1px rgba(0,0,0,.1);\r\n}\r\n\r\ninput.clr-color {\r\n  order: 1;\r\n  width: calc(100% - 80px);\r\n  height: 32px;\r\n  margin: 15px 20px 20px 0;\r\n  padding: 0 10px;\r\n  border: 1px solid #ddd;\r\n  border-radius: 16px;\r\n  color: #444;\r\n  background-color: #fff;\r\n  font-family: sans-serif;\r\n  font-size: 14px;\r\n  text-align: center;\r\n  box-shadow: none;\r\n}\r\n\r\ninput.clr-color:focus {\r\n  outline: none;\r\n  border: 1px solid #1e90ff;\r\n}\r\n\r\n.clr-clear {\r\n  display: none;\r\n  order: 2;\r\n  height: 24px;\r\n  margin: 0 20px 20px auto;\r\n  padding: 0 20px;\r\n  border: 0;\r\n  border-radius: 12px;\r\n  color: #fff;\r\n  background-color: #666;\r\n  font-family: inherit;\r\n  font-size: 12px;\r\n  font-weight: 400;\r\n  cursor: pointer;\r\n}\r\n\r\n.clr-preview {\r\n  position: relative;\r\n  width: 32px;\r\n  height: 32px;\r\n  margin: 15px 0 20px 20px;\r\n  border: 0;\r\n  border-radius: 50%;\r\n  overflow: hidden;\r\n  cursor: pointer;\r\n}\r\n\r\n.clr-preview:before,\r\n.clr-preview:after {\r\n  content: \'\';\r\n  position: absolute;\r\n  height: 100%;\r\n  width: 100%;\r\n  left: 0;\r\n  top: 0;\r\n  border: 1px solid #fff;\r\n  border-radius: 50%;\r\n}\r\n\r\n.clr-preview:after {\r\n  border: 0;\r\n  background-color: currentColor;\r\n  box-shadow: inset 0 0 0 1px rgba(0,0,0,.1);\r\n}\r\n\r\n.clr-marker,\r\n.clr-hue div,\r\n.clr-alpha div,\r\n.clr-color {\r\n  box-sizing: border-box;\r\n}\r\n\r\n.clr-field {\r\n  display: inline-block;\r\n  position: relative;\r\n  color: transparent;\r\n}\r\n\r\n.clr-field button {\r\n  position: absolute;\r\n  width: 30px;\r\n  height: 100%;\r\n  right: 0;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  border: 0;\r\n  color: inherit;\r\n  text-indent: -1000px;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  pointer-events: none;\r\n}\r\n\r\n.clr-field button:after {\r\n  content: \'\';\r\n  display: block;\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 100%;\r\n  left: 0;\r\n  top: 0;\r\n  border-radius: inherit;\r\n  background-color: currentColor;\r\n  box-shadow: inset 0 0 1px rgba(0,0,0,.5);\r\n}\r\n\r\n.clr-alpha,\r\n.clr-alpha div,\r\n.clr-swatches button,\r\n.clr-preview:before,\r\n.clr-field button {\r\n  background-image: repeating-linear-gradient(45deg, #aaa 25%, transparent 25%, transparent 75%, #aaa 75%, #aaa), repeating-linear-gradient(45deg, #aaa 25%, #fff 25%, #fff 75%, #aaa 75%, #aaa);\r\n  background-position: 0 0, 4px 4px;\r\n  background-size: 8px 8px;\r\n}\r\n\r\n.clr-marker:focus {\r\n  outline: none;\r\n}\r\n\r\n.clr-keyboard-nav .clr-marker:focus,\r\n.clr-keyboard-nav .clr-hue input:focus + div,\r\n.clr-keyboard-nav .clr-alpha input:focus + div,\r\n.clr-keyboard-nav .clr-segmented input:focus + label {\r\n  outline: none;\r\n  box-shadow: 0 0 0 2px #1e90ff, 0 0 2px 2px #fff;\r\n}\r\n\r\n.clr-picker[data-alpha="false"] .clr-alpha {\r\n  display: none;\r\n}\r\n\r\n.clr-picker[data-minimal="true"] {\r\n  padding-top: 16px;\r\n}\r\n\r\n.clr-picker[data-minimal="true"] .clr-gradient,\r\n.clr-picker[data-minimal="true"] .clr-hue,\r\n.clr-picker[data-minimal="true"] .clr-alpha,\r\n.clr-picker[data-minimal="true"] .clr-color,\r\n.clr-picker[data-minimal="true"] .clr-preview {\r\n  display: none;\r\n}\r\n\r\n/** Dark theme **/\r\n\r\n.clr-dark {\r\n  background-color: #444;\r\n}\r\n\r\n.clr-dark .clr-segmented {\r\n  border-color: #777;\r\n}\r\n\r\n.clr-dark .clr-swatches button:after {\r\n  box-shadow: inset 0 0 0 1px rgba(255,255,255,.3);\r\n}\r\n\r\n.clr-dark input.clr-color {\r\n  color: #fff;\r\n  border-color: #777;\r\n  background-color: #555;\r\n}\r\n\r\n.clr-dark input.clr-color:focus {\r\n  border-color: #1e90ff;\r\n}\r\n\r\n.clr-dark .clr-preview:after {\r\n  box-shadow: inset 0 0 0 1px rgba(255,255,255,.5);\r\n}\r\n\r\n.clr-dark .clr-alpha,\r\n.clr-dark .clr-alpha div,\r\n.clr-dark .clr-swatches button,\r\n.clr-dark .clr-preview:before {\r\n  background-image: repeating-linear-gradient(45deg, #666 25%, transparent 25%, transparent 75%, #888 75%, #888), repeating-linear-gradient(45deg, #888 25%, #444 25%, #444 75%, #888 75%, #888);\r\n}\r\n\r\n/** Polaroid theme **/\r\n\r\n.clr-picker.clr-polaroid {\r\n  border-radius: 6px;\r\n  box-shadow: 0 0 5px rgba(0,0,0,.1), 0 5px 30px rgba(0,0,0,.2);\r\n}\r\n\r\n.clr-picker.clr-polaroid:before {\r\n  content: \'\';\r\n  display: block;\r\n  position: absolute;\r\n  width: 16px;\r\n  height: 10px;\r\n  left: 20px;\r\n  top: -10px;\r\n  border: solid transparent;\r\n  border-width: 0 8px 10px 8px;\r\n  border-bottom-color: currentColor;\r\n  box-sizing: border-box;\r\n  color: #fff;\r\n  filter: drop-shadow(0 -4px 3px rgba(0,0,0,.1));\r\n  pointer-events: none;\r\n}\r\n\r\n.clr-picker.clr-polaroid.clr-dark:before {\r\n  color: #444;\r\n}\r\n\r\n.clr-picker.clr-polaroid.clr-left:before {\r\n  left: auto;\r\n  right: 20px;\r\n}\r\n\r\n.clr-picker.clr-polaroid.clr-top:before {\r\n  top: auto;\r\n  bottom: -10px;\r\n  transform: rotateZ(180deg);\r\n}\r\n\r\n.clr-polaroid .clr-gradient {\r\n  width: calc(100% - 20px);\r\n  height: 120px;\r\n  margin: 10px;\r\n  border-radius: 3px;\r\n}\r\n\r\n.clr-polaroid .clr-hue,\r\n.clr-polaroid .clr-alpha {\r\n  width: calc(100% - 30px);\r\n  height: 10px;\r\n  margin: 6px 15px;\r\n  border-radius: 5px;\r\n}\r\n\r\n.clr-polaroid .clr-hue div,\r\n.clr-polaroid .clr-alpha div {\r\n  box-shadow: 0 0 5px rgba(0,0,0,.2);\r\n}\r\n\r\n.clr-polaroid .clr-format {\r\n  width: calc(100% - 20px);\r\n  margin: 0 10px 15px;\r\n}\r\n\r\n.clr-polaroid .clr-swatches {\r\n  width: calc(100% - 12px);\r\n  margin: 0 6px;\r\n}\r\n.clr-polaroid .clr-swatches div {\r\n  padding-bottom: 10px;\r\n}\r\n\r\n.clr-polaroid .clr-swatches button {\r\n  width: 22px;\r\n  height: 22px;\r\n}\r\n\r\n.clr-polaroid input.clr-color {\r\n  width: calc(100% - 60px);\r\n  margin: 10px 10px 15px 0;\r\n}\r\n\r\n.clr-polaroid .clr-clear {\r\n  margin: 0 10px 15px auto;\r\n}\r\n\r\n.clr-polaroid .clr-preview {\r\n  margin: 10px 0 15px 10px;\r\n}\r\n\r\n/** Large theme **/\r\n\r\n.clr-picker.clr-large {\r\n  width: 275px;\r\n}\r\n\r\n.clr-large .clr-gradient {\r\n  height: 150px;\r\n}\r\n\r\n.clr-large .clr-swatches button {\r\n  width: 22px;\r\n  height: 22px;\r\n}',""]);const a=s},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<t.length;c++){var h=[].concat(t[c]);r&&s[h[0]]||(void 0!==o&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=o),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),i&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=i):h[4]="".concat(i)),e.push(h))}},e}},81:t=>{"use strict";t.exports=function(t){return t[1]}},49:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>v});var r=n(379),i=n.n(r),o=n(795),s=n.n(o),a=n(569),l=n.n(a),c=n(565),h=n.n(c),d=n(216),u=n.n(d),p=n(589),f=n.n(p),m=n(408),g={};g.styleTagTransform=f(),g.setAttributes=h(),g.insert=l().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=u();i()(m.Z,g);const v=m.Z&&m.Z.locals?m.Z.locals:void 0},819:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>v});var r=n(379),i=n.n(r),o=n(795),s=n.n(o),a=n(569),l=n.n(a),c=n(565),h=n.n(c),d=n(216),u=n.n(d),p=n(589),f=n.n(p),m=n(872),g={};g.styleTagTransform=f(),g.setAttributes=h(),g.insert=l().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=u();i()(m.Z,g);const v=m.Z&&m.Z.locals?m.Z.locals:void 0},457:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>v});var r=n(379),i=n.n(r),o=n(795),s=n.n(o),a=n(569),l=n.n(a),c=n(565),h=n.n(c),d=n(216),u=n.n(d),p=n(589),f=n.n(p),m=n(786),g={};g.styleTagTransform=f(),g.setAttributes=h(),g.insert=l().bind(null,"head"),g.domAPI=s(),g.insertStyleElement=u();i()(m.Z,g);const v=m.Z&&m.Z.locals?m.Z.locals:void 0},379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},s=[],a=0;a<t.length;a++){var l=t[a],c=r.base?l[0]+r.base:l[0],h=o[c]||0,d="".concat(c," ").concat(h);o[c]=h+1;var u=n(d),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var f=i(p,r);r.byIndex=a,e.splice(a,0,{identifier:d,updater:f,references:1})}s.push(d)}return s}function i(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=r(t=t||[],i=i||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var l=r(t,i),c=0;c<o.length;c++){var h=n(o[c]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}o=l}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},813:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(t,e,n,r){this.r=t,this.g=e,this.b=n,this.a=r,this.hexString=null}static ofRGB(t,e,r){return new n(t,e,r,1)}static ofRGBA(t,e,r,i){return new n(t,e,r,i)}static fromHex(t){if(!(t=(t=t.match(/^[#]?(.*)$/)[1]).toUpperCase()).match(/^[0-9A-F]+$/))throw new Error(`${t} is not in a valid format.`);if(3===t.length||4===t.length){const e=t.split("");t=e.map((t=>`${t}0`)).join("")}6===t.length&&(t+="FF");const e=[];for(let n=2;n<=t.length;n+=2){const r=t.substring(n-2,n);e.push(parseInt(r,16)/255)}if(4!==e.length)throw new Error(`Unable to parse ${t}: Wrong number of components.`);return new n(e[0],e[1],e[2],e[3])}static fromString(t){if(t.startsWith("#"))return n.fromHex(t);{const e=document.createElement("canvas");e.width=1,e.height=1;const r=e.getContext("2d");r.fillStyle=t,r.fillRect(0,0,1,1);const i=r.getImageData(0,0,1,1),o=i.data[0]/255,s=i.data[1]/255,a=i.data[2]/255,l=i.data[3]/255;return n.ofRGBA(o,s,a,l)}}eq(t){return null!==(null!=t?t:null)&&this.toHexString()===t.toHexString()}toHexString(){if(this.hexString)return this.hexString;const t=t=>{const e=Math.round(255*t).toString(16);return 1===e.length?`0${e}`:e},e=t(this.a),n=t(this.r),r=t(this.g),i=t(this.b);return"ff"===e?`#${n}${r}${i}`:(this.hexString=`#${n}${r}${i}${e}`,this.hexString)}}e.default=n,n.transparent=n.ofRGBA(0,0,0,0),n.red=n.ofRGB(1,0,0),n.green=n.ofRGB(0,1,0),n.blue=n.ofRGB(0,0,1),n.purple=n.ofRGB(.5,.2,.5),n.yellow=n.ofRGB(1,1,.1),n.clay=n.ofRGB(.8,.4,.2),n.black=n.ofRGB(0,0,0),n.white=n.ofRGB(1,1,1)},581:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RenderingMode=void 0;const r=n(929),i=n(624),o=n(988);var s;!function(t){t[t.DummyRenderer=0]="DummyRenderer",t[t.CanvasRenderer=1]="CanvasRenderer"}(s=e.RenderingMode||(e.RenderingMode={}));e.default=class{constructor(t,e,n){this.editor=t,this.parent=n,e===s.CanvasRenderer?this.initializeCanvasRendering():(this.dryInkRenderer=new o.default(t.viewport),this.wetInkRenderer=new o.default(t.viewport)),this.editor.notifier.on(i.EditorEventType.DisplayResized,(t=>{var e;if(t.kind!==i.EditorEventType.DisplayResized)throw new Error("Mismatched event.kinds!");null===(e=this.resizeSurfacesCallback)||void 0===e||e.call(this)}))}get width(){return this.dryInkRenderer.displaySize().x}get height(){return this.dryInkRenderer.displaySize().y}initializeCanvasRendering(){const t=document.createElement("canvas"),e=document.createElement("canvas"),n=t.getContext("2d"),i=e.getContext("2d");this.dryInkRenderer=new r.default(n,this.editor.viewport),this.wetInkRenderer=new r.default(i,this.editor.viewport),t.className="dryInkCanvas",e.className="wetInkCanvas",this.parent&&(this.parent.appendChild(t),this.parent.appendChild(e)),this.resizeSurfacesCallback=()=>{const n=t=>t.clientHeight!==t.height||t.clientWidth!==t.width;(n(t)||n(e))&&(t.width=t.clientWidth,t.height=t.clientHeight,e.width=e.clientWidth,e.height=e.clientHeight)},this.resizeSurfacesCallback(),this.flattenCallback=()=>{n.drawImage(e,0,0)}}startRerender(){var t;return null===(t=this.resizeSurfacesCallback)||void 0===t||t.call(this),this.wetInkRenderer.clear(),this.dryInkRenderer.clear(),this.dryInkRenderer}getDryInkRenderer(){return this.dryInkRenderer}getWetInkRenderer(){return this.wetInkRenderer}flatten(){var t;null===(t=this.flattenCallback)||void 0===t||t.call(this)}}},220:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ImageNode=void 0;const r=n(417);class i{constructor(){this.root=new o}addElement(t){return this.root.addLeaf(t)}findParent(t){const e=this.root.getLeavesInRegion(t.getBBox());for(const n of e)if(n.getContent()===t)return n;return null}sortLeaves(t){t.sort(((t,e)=>t.getContent().zIndex-e.getContent().zIndex))}render(t,e,n=.001){const r=this.root.getLeavesInRegion(e.visibleRect,n);this.sortLeaves(r);for(const n of r)n.getContent().render(t,e.visibleRect)}renderAll(t){const e=this.root.getLeaves();this.sortLeaves(e);for(const n of e)n.getContent().render(t,n.getBBox())}getElementsIntersectingRegion(t){const e=this.root.getLeavesInRegion(t);return this.sortLeaves(e),e.map((t=>t.getContent()))}}e.default=i,i.AddElementCommand=class{constructor(t,e=!1){this.element=t,this.applyByFlattening=e}apply(t){t.image.addElement(this.element),this.applyByFlattening?(this.applyByFlattening=!1,t.display.flatten()):t.queueRerender()}unapply(t){const e=t.image.findParent(this.element);null==e||e.remove(),t.queueRerender()}};class o{constructor(t=null){this.parent=t,this.targetChildCount=30,this.children=[],this.bbox=r.default.empty,this.content=null}getContent(){return this.content}getParent(){return this.parent}getChildrenInRegion(t){return this.children.filter((e=>e.getBBox().intersects(t)))}getLeavesInRegion(t,e=0){const n=[];if(this.bbox.maxDimension/t.maxDimension<=e)return[];null!==this.content&&this.getBBox().intersects(t)&&n.push(this);const r=this.getChildrenInRegion(t);for(const i of r)n.push(...i.getLeavesInRegion(t,e));return n}getLeaves(){if(this.content)return[this];const t=[];for(const e of this.children)t.push(...e.getLeaves());return t}addLeaf(t){if(null===this.content&&0===this.children.length)return this.content=t,this.recomputeBBox(!0),this;if(null!==this.content){console.assert(0===this.children.length);const t=new o(this);t.content=this.content,this.content=null,this.children.push(t),t.recomputeBBox(!1)}const e=t.getBBox();if(e.containsRect(this.getBBox())){const e=new o(this),n=new o(this);return n.children=this.children,this.children=[e,n],n.recomputeBBox(!0),e.addLeaf(t)}const n=this.children.filter((t=>t.getBBox().containsRect(e)));if(n.length>0&&this.children.length>=this.targetChildCount){n.sort(((t,e)=>t.getBBox().area-e.getBBox().area));const e=n[0].addLeaf(t);return e.rebalance(),e}const r=new o(this);return this.children.push(r),r.content=t,r.recomputeBBox(!0),r}getBBox(){return this.bbox}recomputeBBox(t){var e;const n=this.bbox;if(null!==this.content)this.bbox=this.content.getBBox();else{this.bbox=r.default.empty;for(const t of this.children)this.bbox=this.bbox.union(t.getBBox())}t&&!n.eq(this.bbox)&&(null===(e=this.parent)||void 0===e||e.recomputeBBox(!0))}rebalance(){if(this.parent&&1===this.parent.children.length)if(console.assert(null===this.parent.content),console.assert(this.parent.children[0]===this),null!==this.parent.parent){const t=this.parent;t.children=[],this.parent=t.parent,this.parent.children.push(this),t.parent=null,this.parent.recomputeBBox(!1)}else null===this.content&&(this.parent.children=this.children,this.parent=null)}remove(){if(!this.parent)return this.content=null,void(this.children=[]);const t=this.parent.children.length;this.parent.children=this.parent.children.filter((t=>t!==this)),console.assert(this.parent.children.length===t-1),this.parent.children.forEach((t=>{t.rebalance()})),this.parent.recomputeBBox(!0),this.content=null,this.parent=null,this.children=[]}}e.ImageNode=o},168:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PointerDevice=void 0;const r=n(652);var i;!function(t){t[t.Pen=0]="Pen",t[t.Touch=1]="Touch",t[t.Mouse=2]="Mouse",t[t.Other=3]="Other"}(i=e.PointerDevice||(e.PointerDevice={}));class o{constructor(t,e,n,r,i,o,s,a){this.screenPos=t,this.canvasPos=e,this.pressure=n,this.isPrimary=r,this.down=i,this.device=o,this.id=s,this.timeStamp=a}static ofEvent(t,e,n){var s,a;const l=r.Vec2.of(t.clientX,t.clientY),c=null!==(s={mouse:i.Mouse,pen:i.Pen,touch:i.Touch}[t.pointerType])&&void 0!==s?s:i.Other,h=(new Date).getTime(),d=n.screenToCanvas(l);return new o(l,d,null!==(a=t.pressure)&&void 0!==a?a:null,t.isPrimary,e,c,t.pointerId,h)}static ofCanvasPoint(t,e,n,r=0,s=i.Pen,a=!0,l=null){const c=n.canvasToScreen(t),h=(new Date).getTime();return new o(c,t,l,a,e,s,r,h)}}e.default=o},650:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.SVGEditor=void 0;const i=n(220),o=n(700),s=n(624),a=n(558),l=n(355),c=n(862),h=n(652),d=n(8),u=n(639),p=n(581),f=n(239),m=n(813),g=n(351);n(49);const v=n(168),y=n(270);class x{constructor(t,e=p.RenderingMode.CanvasRenderer,n=!0,r){this.lightMode=n,this.localization=Object.assign(Object.assign({},u.default.defaultLocalization),{loading:"Loading {}%...",imageEditor:"Image Editor"}),this.rerenderQueued=!1,this.container=document.createElement("div"),this.renderingRegion=document.createElement("div"),this.container.appendChild(this.renderingRegion),this.container.className="imageEditorContainer",this.localization=null!=r?r:this.localization,this.loadingWarning=document.createElement("div"),this.loadingWarning.classList.add("loadingMessage"),this.container.appendChild(this.loadingWarning),this.renderingRegion.style.touchAction="none",this.renderingRegion.className="imageEditorRenderArea",this.renderingRegion.setAttribute("tabIndex","0"),this.renderingRegion.ariaLabel=this.localization.imageEditor,this.notifier=new c.default,this.importExportViewport=new l.default(this.notifier),this.viewport=new l.default(this.notifier),this.display=new p.default(this,e,this.renderingRegion),this.image=new i.default,this.history=new a.default(this),this.toolController=new o.default(this),t.appendChild(this.container),this.importExportViewport.updateScreenSize(h.Vec2.of(500,500)),this.viewport.updateScreenSize(h.Vec2.of(this.display.width,this.display.height)),this.registerListeners(),this.rerender(),this.hideLoadingWarning()}showLoadingWarning(t){const e=Math.round(100*t);this.loadingWarning.innerText=this.localization.loading.replace("{}",e.toString()),this.loadingWarning.style.display="block"}hideLoadingWarning(){this.loadingWarning.style.display="none"}addToolbar(){return new u.default(this,this.container,this.localization)}registerListeners(){const t={},e=()=>{const e=(new Date).getTime(),n=[];for(const r in t){const i=2e3;t[r]&&e-t[r].timeStamp<i&&n.push(t[r])}return n};this.renderingRegion.addEventListener("touchstart",(t=>t.preventDefault())),this.renderingRegion.addEventListener("pointerdown",(n=>{const r=v.default.ofEvent(n,!0,this.viewport);t[r.id]=r,this.renderingRegion.setPointerCapture(r.id);const i={kind:s.InputEvtType.PointerDownEvt,current:r,allPointers:e()};return this.toolController.dispatchInputEvent(i),!0})),this.renderingRegion.addEventListener("pointermove",(n=>{var r,i;const o=v.default.ofEvent(n,null!==(i=null===(r=t[n.pointerId])||void 0===r?void 0:r.down)&&void 0!==i&&i,this.viewport);o.down&&(t[o.id]=o,this.toolController.dispatchInputEvent({kind:s.InputEvtType.PointerMoveEvt,current:o,allPointers:e()})&&n.preventDefault())}));const n=n=>{const r=v.default.ofEvent(n,!1,this.viewport);t[r.id]&&(t[r.id]=r,this.renderingRegion.releasePointerCapture(r.id),this.toolController.dispatchInputEvent({kind:s.InputEvtType.PointerUpEvt,current:r,allPointers:e()})&&n.preventDefault(),delete t[r.id])};this.renderingRegion.addEventListener("pointerup",(t=>{n(t)})),this.renderingRegion.addEventListener("pointercancel",(t=>{n(t)})),this.renderingRegion.addEventListener("keydown",(t=>{this.toolController.dispatchInputEvent({kind:s.InputEvtType.KeyPressEvent,key:t.key})&&t.preventDefault()})),this.container.addEventListener("wheel",(t=>{let e=d.default.of(t.deltaX,t.deltaY,t.deltaZ);t.deltaMode===WheelEvent.DOM_DELTA_LINE?e=e.times(15):t.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(e=e.times(100)),t.ctrlKey&&(e=d.default.of(0,0,t.deltaY));const n=h.Vec2.of(t.clientX,t.clientY);return!!this.toolController.dispatchInputEvent({kind:s.InputEvtType.WheelEvt,delta:e,screenPos:n})&&(t.preventDefault(),!0)})),window.addEventListener("resize",(()=>{this.notifier.dispatch(s.EditorEventType.DisplayResized,{kind:s.EditorEventType.DisplayResized,newSize:h.Vec2.of(this.display.width,this.display.height)}),this.viewport.updateScreenSize(h.Vec2.of(this.display.width,this.display.height)),this.queueRerender()}))}dispatch(t){this.history.push(t)}asyncApplyOrUnapplyCommands(t,e,n){return r(this,void 0,void 0,(function*(){for(let r=0;r<t.length;r+=n){this.showLoadingWarning(r/t.length);for(let i=r;i<t.length&&i<r+n;i++){const n=t[i];e?n.apply(this):n.unapply(this)}r+n<t.length&&(yield new Promise((t=>{this.rerender(),requestAnimationFrame(t)})))}this.hideLoadingWarning()}))}asyncApplyCommands(t,e){return this.asyncApplyOrUnapplyCommands(t,!0,e)}asyncUnapplyCommands(t,e){return this.asyncApplyOrUnapplyCommands(t,!1,e)}queueRerender(){this.rerenderQueued||(this.rerenderQueued=!0,requestAnimationFrame((()=>{this.rerender(),this.rerenderQueued=!1})))}rerender(t=!0){this.display.startRerender();const e=this.display.getDryInkRenderer();if(t){const t={fill:m.default.fromHex("#44444455")},n=12;e.drawRect(this.importExportViewport.visibleRect,n,t)}this.image.render(e,this.viewport),this.rerenderQueued=!1}drawWetInk(...t){for(const e of t)this.display.getWetInkRenderer().drawPath(e)}clearWetInk(){this.display.getWetInkRenderer().clear()}createHTMLOverlay(t){return t.classList.add("overlay"),this.container.appendChild(t),{remove:()=>t.remove()}}addStyleSheet(t){const e=document.createElement("style");return e.innerText=t,this.container.appendChild(e),e}sendPenEvent(t,e,n){const r=v.default.ofCanvasPoint(e,t!==s.InputEvtType.PointerUpEvt,this.viewport);this.toolController.dispatchInputEvent({kind:t,allPointers:null!=n?n:[r],current:r})}toSVG(){const t=this.importExportViewport,e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"svg"),r=new f.default(n,t),i=t.canvasToScreenTransform;t.resetTransform(y.default.identity),this.image.renderAll(r),t.resetTransform(i);const o=t.visibleRect;return n.setAttribute("viewBox",`${o.x} ${o.y} ${o.w} ${o.h}`),n.setAttribute("width",`${o.w}`),n.setAttribute("height",`${o.h}`),n.setAttribute("version","1.1"),n.setAttribute("baseProfile","full"),n.setAttribute("xmlns",e),n}loadFrom(t){return r(this,void 0,void 0,(function*(){this.showLoadingWarning(0);const e=yield t.start((t=>{new i.default.AddElementCommand(t).apply(this)}),((t,e)=>t%100==0?(this.showLoadingWarning(t/e),this.rerender(!1),new Promise((t=>{requestAnimationFrame((()=>t()))}))):null));this.hideLoadingWarning(),this.setImportExportRect(e).apply(this)}))}getImportExportRect(){return this.importExportViewport.visibleRect}setImportExportRect(t){const e=this.importExportViewport.visibleRect.size,n=this.importExportViewport.canvasToScreenTransform;return{apply(e){const n=e.importExportViewport;n.updateScreenSize(t.size),n.resetTransform(y.default.translation(t.topLeft.times(-1))),e.queueRerender()},unapply(t){const r=t.importExportViewport;r.updateScreenSize(e),r.resetTransform(n),t.queueRerender()}}}loadFromSVG(t){return r(this,void 0,void 0,(function*(){const e=g.default.fromString(t);yield this.loadFrom(e)}))}}e.SVGEditor=x,e.default=x},351:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.defaultSVGViewRect=void 0;const i=n(813),o=n(56),s=n(111),a=n(781),l=n(417);e.defaultSVGViewRect=new l.default(0,0,500,500);class c{constructor(t,e){this.source=t,this.onFinish=e,this.onAddComponent=null,this.onProgress=null,this.processedCount=0,this.totalToProcess=0}getStyle(t){var e,n,r;const o={fill:i.default.transparent},s=null!==(e=t.getAttribute("fill"))&&void 0!==e?e:t.style.fill;if(s)try{o.fill=i.default.fromString(s)}catch(t){console.error("Unknown fill color,",s)}const a=null!==(n=t.getAttribute("stroke"))&&void 0!==n?n:t.style.stroke,l=null!==(r=t.getAttribute("stroke-width"))&&void 0!==r?r:t.style.strokeWidth;if(a)try{let t=parseFloat(null!=l?l:"1");isFinite(t)||(t=0),o.stroke={width:t,color:i.default.fromString(a)}}catch(t){console.error("Error parsing stroke data:",t)}return o}strokeDataFromElem(t){var e;const n=[],r=null!==(e=t.getAttribute("d"))&&void 0!==e?e:"",i=this.getStyle(t),o=r.split("M");let s=!0;for(const t of o){if(""!==t){const e=s?t:`M${t}`,r=a.default.fromString(e).toRenderable(i);n.push(r)}s=!1}return n}addPath(t){var e;let n;try{const e=this.strokeDataFromElem(t);n=new o.default(e)}catch(e){console.error("Invalid path in node",t,"\nError:",e,"\nAdding as an unknown object."),n=new s.default(t)}null===(e=this.onAddComponent)||void 0===e||e.call(this,n)}addUnknownNode(t){var e;const n=new s.default(t);null===(e=this.onAddComponent)||void 0===e||e.call(this,n)}updateViewBox(t){const e=t.getAttribute("viewBox");if(this.rootViewBox||!e)return;const n=e.split(/[ \t,]/),r=parseFloat(n[0]),i=parseFloat(n[1]),o=parseFloat(n[2]),s=parseFloat(n[3]);isNaN(r)||isNaN(i)||isNaN(o)||isNaN(s)||(this.rootViewBox=new l.default(r,i,o,s))}visit(t){var e;return r(this,void 0,void 0,(function*(){switch(this.totalToProcess+=t.childElementCount,t.tagName.toLowerCase()){case"g":break;case"path":this.addPath(t);break;case"svg":this.updateViewBox(t);break;default:return console.warn("Unknown SVG element,",t),void(t instanceof SVGElement?this.addUnknownNode(t):console.error("Element",t,"is not an SVGElement!"))}for(const e of t.children)yield this.visit(e);this.processedCount++,yield null===(e=this.onProgress)||void 0===e?void 0:e.call(this,this.processedCount,this.totalToProcess)}))}start(t,n){var i;return r(this,void 0,void 0,(function*(){this.onAddComponent=t,this.onProgress=n,this.totalToProcess=this.source.childElementCount,this.processedCount=0,this.rootViewBox=null,yield this.visit(this.source);const r=this.rootViewBox;let o=e.defaultSVGViewRect;return r&&(o=l.default.of(r)),null===(i=this.onFinish)||void 0===i||i.call(this),o}))}static fromString(t){var e,n;const r=document.createElement("iframe");if(r.src="about:blank",r.setAttribute("sandbox","allow-same-origin"),r.setAttribute("csp","default-src 'about:blank'"),r.style.display="none",document.body.appendChild(r),!r.hasAttribute("sandbox"))throw r.remove(),new Error("SVG loading iframe is not sandboxed.");const i=null!==(n=null===(e=r.contentWindow)||void 0===e?void 0:e.document)&&void 0!==n?n:r.contentDocument;i.open(),i.write("\n\t\t\t<!DOCTYPE html>\n\t\t\t<html>\n\t\t\t\t<head>\n\t\t\t\t\t<title>SVG Loading Sandbox</title>\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<script>\n\t\t\t\t\t\tconsole.error('JavaScript should not be able to run here!');\n\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t'The SVG sandbox is broken! Please double-check the sandboxing setting.'\n\t\t\t\t\t\t);\n\t\t\t\t\t<\/script>\n\t\t\t\t</body>\n\t\t\t</html>\n\t\t"),i.close();const o=i.createElementNS("http://www.w3.org/2000/svg","svg");return o.innerHTML=t,new c(o,(()=>{r.remove()}))}}e.default=c},995:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(405),i=n(652),o=n(417),s=n(781),a=n(412),l=n(56),c=n(355);e.default=class{constructor(t,e,n){this.startPoint=t,this.minFitAllowed=e,this.maxFitAllowed=n,this.currentCurve=null,this.lastPoint=this.startPoint,this.segments=[],this.buffer=[this.startPoint.pos],this.momentum=i.Vec2.zero,this.currentCurve=null,this.bbox=new o.default(this.startPoint.pos.x,this.startPoint.pos.y,0,0)}getBBox(){return this.bbox}getRenderingStyle(){var t;return{fill:null!==(t=this.lastPoint.color)&&void 0!==t?t:null}}preview(){if(this.currentCurve&&this.lastPoint){const t=this.currentSegmentToPath();return this.segments.concat(t)}return this.segments}build(){return this.lastPoint&&this.finalizeCurrentCurve(),new l.default(this.segments)}roundPoint(t){return c.default.roundPoint(t,this.minFitAllowed)}finalizeCurrentCurve(){if(!this.currentCurve){const t=c.default.roundPoint(this.startPoint.width/3,this.minFitAllowed),e=this.roundPoint(this.startPoint.pos);return void this.segments.push({startPoint:this.startPoint.pos.plus(i.Vec2.of(t,0)),commands:[{kind:s.PathCommandType.QuadraticBezierTo,controlPoint:e.plus(i.Vec2.of(t,t)),endPoint:e.plus(i.Vec2.of(0,t))},{kind:s.PathCommandType.QuadraticBezierTo,controlPoint:e.plus(i.Vec2.of(-t,t)),endPoint:e.plus(i.Vec2.of(-t,0))},{kind:s.PathCommandType.QuadraticBezierTo,controlPoint:e.plus(i.Vec2.of(-t,-t)),endPoint:e.plus(i.Vec2.of(0,-t))},{kind:s.PathCommandType.QuadraticBezierTo,controlPoint:e.plus(i.Vec2.of(t,-t)),endPoint:e.plus(i.Vec2.of(t,0))}],style:this.getRenderingStyle()})}this.segments.push(this.currentSegmentToPath());const t=this.buffer[this.buffer.length-1];this.lastExitingVec=i.Vec2.ofXY(this.currentCurve.points[2]).minus(i.Vec2.ofXY(this.currentCurve.points[1])),console.assert(0!==this.lastExitingVec.magnitude()),this.buffer=[this.buffer[this.buffer.length-2],t],this.currentCurve=null}currentSegmentToPath(){let t=i.Vec2.ofXY(this.currentCurve.normal(0)).normalized(),e=i.Vec2.ofXY(this.currentCurve.normal(1)).normalized();t=t.times(this.curveStartWidth/2),e=e.times(this.curveEndWidth/2),isNaN(t.magnitude())&&(console.error("startVec is NaN",t,e,this.currentCurve),t=e);const n=i.Vec2.ofXY(this.currentCurve.get(0)),r=i.Vec2.ofXY(this.currentCurve.get(1)),o=i.Vec2.ofXY(this.currentCurve.points[1]),a=this.currentCurve.project(o.xy).t,l=i.Vec2.ofXY(this.currentCurve.normal(a)).normalized().times(this.curveStartWidth/2*a+this.curveEndWidth/2*(1-a)),c=[{kind:s.PathCommandType.QuadraticBezierTo,controlPoint:this.roundPoint(o.plus(l)),endPoint:this.roundPoint(r.plus(e))},{kind:s.PathCommandType.LineTo,point:this.roundPoint(r.minus(e))},{kind:s.PathCommandType.QuadraticBezierTo,controlPoint:this.roundPoint(o.minus(l)),endPoint:this.roundPoint(n.minus(t))}];return{startPoint:this.roundPoint(n.plus(t)),commands:c,style:this.getRenderingStyle()}}computeExitingVec(){return this.momentum.normalized().times(this.lastPoint.width/2)}addPoint(t){var e,n;if(this.lastPoint){const e=1e-10,n=t.time-this.lastPoint.time;if(t.pos.eq(this.lastPoint.pos,e)||0===n)return void console.warn("Discarding identical point");if(isNaN(t.pos.magnitude()))return void console.warn("Discarding NaN point.",t);const r=t.pos.minus(this.lastPoint.pos).times(1/n*1e3);this.momentum=this.momentum.lerp(r,.9)}const o=null!==(e=this.lastPoint)&&void 0!==e?e:t;this.lastPoint=t,this.buffer.push(t.pos);const s=t.width/2,l=this.curveEndWidth;if(this.curveEndWidth=s,this.bbox=this.bbox.grownToPoint(t.pos,s),null===this.currentCurve){const e=o.pos,s=o.pos.plus(null!==(n=this.lastExitingVec)&&void 0!==n?n:i.Vec2.unitX),a=t.pos;this.currentCurve=new r.Bezier(e.xy,s.xy,a.xy),this.curveStartWidth=o.width/2,console.assert(!isNaN(e.magnitude())&&!isNaN(s.magnitude())&&!isNaN(a.magnitude()),"Expected !NaN")}let c=this.lastExitingVec;if(!c){let t=Math.ceil(this.buffer.length/3);0===t&&(t=this.buffer.length-1),c=this.buffer[t].minus(this.buffer[0])}let h=this.computeExitingVec();const d=this.buffer[0],u=t.pos,p=u.minus(d).magnitude(),f=2*p;if(0===f||0===h.magnitude()||isNaN(h.magnitude()))return;console.assert(!isNaN(c.magnitude())),c=c.normalized(),h=h.normalized(),console.assert(!isNaN(c.magnitude()));const m=new a.default(d,d.plus(c.times(f))),g=new a.default(u.minus(h.times(f)),u).intersection(m);let v;v=g?g.point:d.plus(c.times(p/4)),(isNaN(v.magnitude())||isNaN(d.magnitude()))&&console.error("controlPoint is NaN",g,"Start:",d,"End:",u,"in:",c,"out:",h);const y=this.currentCurve;this.currentCurve=new r.Bezier(d.xy,v.xy,u.xy);const x=t=>{for(const e of this.buffer){const n=i.Vec2.ofXY(t.project(e.xy)).minus(e).magnitude();if(n>Math.max(Math.min(this.curveStartWidth,this.curveEndWidth)/2,this.minFitAllowed)||n>this.maxFitAllowed)return!1}return!0};return this.buffer.length>3&&!x(this.currentCurve)?(this.currentCurve=y,this.curveEndWidth=l,this.lastPoint=o,void this.finalizeCurrentCurve()):void 0}}},558:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(624);e.default=class{constructor(t){this.editor=t,this.undoStack=[],this.redoStack=[]}fireUpdateEvent(){this.editor.notifier.dispatch(r.EditorEventType.UndoRedoStackUpdated,{kind:r.EditorEventType.UndoRedoStackUpdated,undoStackSize:this.undoStack.length,redoStackSize:this.redoStack.length})}push(t,e=!0){e&&t.apply(this.editor),this.undoStack.push(t),this.redoStack=[],this.fireUpdateEvent()}undo(){const t=this.undoStack.pop();t&&(this.redoStack.push(t),t.unapply(this.editor)),this.fireUpdateEvent()}redo(){const t=this.redoStack.pop();t&&(this.undoStack.push(t),t.apply(this.editor)),this.fireUpdateEvent()}}},355:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Viewport=void 0;const r=n(270),i=n(417),o=n(8),s=n(624);class a{constructor(t){this.notifier=t,this.resetTransform(r.default.identity),this.screenRect=i.default.empty}updateScreenSize(t){this.screenRect=this.screenRect.resizedTo(t)}get visibleRect(){return this.screenRect.transformedBoundingBox(this.inverseTransform)}screenToCanvas(t){return this.inverseTransform.transformVec2(t)}canvasToScreen(t){return this.transform.transformVec2(t)}resetTransform(t){this.transform=t,this.inverseTransform=t.inverse(),this.notifier.dispatch(s.EditorEventType.ViewportChanged,{kind:s.EditorEventType.ViewportChanged,newTransform:t})}get screenToCanvasTransform(){return this.inverseTransform}get canvasToScreenTransform(){return this.transform}getScaleFactor(){return this.transform.transformVec3(o.default.unitX).magnitude()}getRotationAngle(){return this.transform.transformVec3(o.default.unitX).angle()}static roundPoint(t,e){const n=Math.pow(10,Math.floor(Math.log10(e))),r=t=>Math.round(t/n)*n;return"number"==typeof t?r(t):t.map(r)}roundPoint(t){return a.roundPoint(t,1/this.getScaleFactor())}}e.Viewport=a,a.ViewportTransform=class{constructor(t){this.transform=t,this.inverseTransform=t.inverse()}apply(t){const e=t.viewport;e.resetTransform(e.transform.rightMul(this.transform)),t.queueRerender()}unapply(t){const e=t.viewport;e.resetTransform(e.transform.rightMul(this.inverseTransform)),t.queueRerender()}},e.default=a},663:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(220);e.default=class{constructor(t){this.toRemove=t.map((t=>t))}apply(t){for(const e of this.toRemove){const n=t.image.findParent(e);n&&n.remove()}t.queueRerender()}unapply(t){for(const e of this.toRemove)t.image.findParent(e)||new r.default.AddElementCommand(e).apply(t);t.queueRerender()}}},691:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(220);class i{constructor(){this.lastChangedTime=(new Date).getTime(),this.zIndex=i.zIndexCounter++}getBBox(){return this.contentBBox}transformBy(t){const e=(t,e)=>{const n=t.image.findParent(this);let i=!1;n&&(n.remove(),i=!0),this.applyTransformation(e),i&&new r.default.AddElementCommand(this).apply(t)},n=this.zIndex;return{apply:n=>{this.zIndex=i.zIndexCounter++,e(n,t),n.queueRerender()},unapply:r=>{this.zIndex=n,e(r,t.inverse()),r.queueRerender()}}}}e.default=i,i.zIndexCounter=0},56:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(781),i=n(417),o=n(691);class s extends o.default{constructor(t){var e;super(),this.parts=t.map((t=>{const e=r.default.fromRenderable(t),n=this.bboxForPart(e.bbox,t.style);return this.contentBBox?this.contentBBox=this.contentBBox.union(n):this.contentBBox=n,{path:e,bbox:n,startPoint:e.startPoint,style:t.style,commands:e.parts}})),null!==(e=this.contentBBox)&&void 0!==e||(this.contentBBox=i.default.empty)}intersects(t){for(const e of this.parts)if(e.path.intersection(t).length>0)return!0;return!1}render(t,e){t.startObject(this.getBBox());for(const n of this.parts){n.bbox.intersects(e)&&t.drawPath(n)}t.endObject()}bboxForPart(t,e){return e.stroke?t.grownBy(e.stroke.width/2):t}applyTransformation(t){var e;this.contentBBox=null,this.parts=this.parts.map((e=>{const n=e.path.transformedBy(t),r=this.bboxForPart(n.bbox,e.style);return this.contentBBox?this.contentBBox=this.contentBBox.union(r):this.contentBBox=r,{path:n,bbox:r,startPoint:n.startPoint,commands:n.parts,style:e.style}})),null!==(e=this.contentBBox)&&void 0!==e||(this.contentBBox=i.default.empty)}}e.default=s},111:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(417),i=n(239),o=n(691);class s extends o.default{constructor(t){super(),this.svgObject=t,this.contentBBox=r.default.of(t.getBoundingClientRect())}render(t,e){t instanceof i.default&&t.drawSVGElem(this.svgObject)}intersects(t){return this.contentBBox.getEdges().some((e=>null!==e.intersection(t)))}applyTransformation(t){}}e.default=s},412:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(417),i=n(652);e.default=class{constructor(t,e){this.point1=t,this.point2=e,this.bbox=r.default.bboxOf([t,e]),this.direction=e.minus(t),this.length=this.direction.magnitude(),this.length>0&&(this.direction=this.direction.times(1/this.length))}get p1(){return this.point1}get p2(){return this.point2}get(t){return this.point1.plus(this.direction.times(t))}intersection(t){let e,n;if(0===this.direction.x){if(0===t.direction.x||0===this.direction.y)return null;const r=this.point1.x,o=(this.point1.x-t.point1.x)*t.direction.y/t.direction.x+t.point1.y;e=i.Vec2.of(r,o),n=(o-this.point1.y)/this.direction.y}else{const r=(this.point1.y-t.point1.y)*this.direction.x*t.direction.x+this.direction.x*t.direction.y*t.point1.x-this.direction.y*t.direction.x*this.point1.x,o=t.direction.y*this.direction.x-this.direction.y*t.direction.x;if(0===o)return null;const s=r/o,a=(s-this.point1.x)/this.direction.x,l=this.point1.y+this.direction.y*a;e=i.Vec2.of(s,l),n=(s-this.point1.x)/this.direction.x}const r=e.minus(this.point1).magnitude(),o=e.minus(this.point2).magnitude(),s=e.minus(t.point1).magnitude(),a=e.minus(t.point2).magnitude();return r>this.length||o>this.length||s>t.length||a>t.length?null:{point:e,t:n}}}},270:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(652),i=n(8);class o{constructor(t,e,n,r,o,s,a,l,c){this.a1=t,this.a2=e,this.a3=n,this.b1=r,this.b2=o,this.b3=s,this.c1=a,this.c2=l,this.c3=c,this.cachedInverse=void 0,this.rows=[i.default.of(t,e,n),i.default.of(r,o,s),i.default.of(a,l,c)]}static ofRows(t,e,n){return new o(t.x,t.y,t.z,e.x,e.y,e.z,n.x,n.y,n.z)}inverse(){var t;return null!==(t=this.computeInverse())&&void 0!==t?t:o.identity}invertable(){return null!==this.computeInverse()}computeInverse(){if(void 0!==this.cachedInverse)return this.cachedInverse;const t=[this.rows[0],this.rows[1],this.rows[2]],e=[i.default.unitX,i.default.unitY,i.default.unitZ];for(let n=0;n<3;n++){let r=t[n].at(n);const i=1e-10;if(Math.abs(r)<i){let o=-1;for(let e=1;e<=2;e++){const r=(n+e)%3;if(Math.abs(t[r].at(n))>=i){o=r;break}}if(-1===o)return this.cachedInverse=null,null;const s=t[n],a=e[n];t[n]=t[o],e[n]=e[o],t[o]=s,e[o]=a,r=t[n].at(n)}let o=1/r;t[n]=t[n].times(o),e[n]=e[n].times(o);const s=t[n],a=e[n];for(let r=1;r<=2;r++){const i=(n+r)%3;o=-t[i].at(n),t[i]=t[i].plus(s.times(o)),e[i]=e[i].plus(a.times(o))}}const n=o.ofRows(e[0],e[1],e[2]);return this.cachedInverse=n,n}transposed(){return new o(this.a1,this.b1,this.c1,this.a2,this.b2,this.c2,this.a3,this.b3,this.c3)}rightMul(t){t=t.transposed();const e=(e,n)=>this.rows[e].dot(t.rows[n]);return new o(e(0,0),e(0,1),e(0,2),e(1,0),e(1,1),e(1,2),e(2,0),e(2,1),e(2,2))}transformVec2(t){let e=i.default.of(t.x,t.y,1);return e=this.transformVec3(e),r.Vec2.of(e.x,e.y)}transformVec3(t){return i.default.of(this.rows[0].dot(t),this.rows[1].dot(t),this.rows[2].dot(t))}eq(t,e=0){for(let n=0;n<3;n++)if(!this.rows[n].eq(t.rows[n],e))return!1;return!0}toString(){return`\n ${this.a1},\t ${this.a2},\t ${this.a3}\t \n ${this.b1},\t ${this.b2},\t ${this.b3}\t \n ${this.c1},\t ${this.c2},\t ${this.c3}\t \n\t\t`.trimRight()}toArray(){return[this.a1,this.a2,this.a3,this.b1,this.b2,this.b3,this.c1,this.c2,this.c3]}static translation(t){return new o(1,0,t.x,0,1,t.y,0,0,1)}static zRotation(t,e=r.Vec2.zero){const n=Math.cos(t),i=Math.sin(t);let s=o.translation(e);return s=s.rightMul(new o(n,-i,0,i,n,0,0,0,1)),s.rightMul(o.translation(e.times(-1)))}static scaling2D(t,e=r.Vec2.zero){let n,i,s=o.translation(e);return"number"==typeof t?(n=t,i=t):(n=t.x,i=t.y),s=s.rightMul(new o(n,0,0,0,i,0,0,0,1)),s.rightMul(o.translation(e.times(-1)))}}e.default=o,o.identity=new o(1,0,0,0,1,0,0,0,1)},781:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PathCommandType=void 0;const r=n(405),i=n(412),o=n(417),s=n(652);var a;!function(t){t[t.LineTo=0]="LineTo",t[t.MoveTo=1]="MoveTo",t[t.CubicBezierTo=2]="CubicBezierTo",t[t.QuadraticBezierTo=3]="QuadraticBezierTo"}(a=e.PathCommandType||(e.PathCommandType={}));class l{constructor(t,e){this.startPoint=t,this.parts=e,this.cachedGeometry=null,this.bbox=o.default.bboxOf([t]);for(const n of e)this.bbox=this.bbox.union(l.computeBBoxForSegment(t,n))}get geometry(){if(this.cachedGeometry)return this.cachedGeometry;let t=this.startPoint;const e=[];for(const n of this.parts)switch(n.kind){case a.CubicBezierTo:e.push(new r.Bezier(t.xy,n.controlPoint1.xy,n.controlPoint2.xy,n.endPoint.xy)),t=n.endPoint;break;case a.QuadraticBezierTo:e.push(new r.Bezier(t.xy,n.controlPoint.xy,n.endPoint.xy)),t=n.endPoint;break;case a.LineTo:e.push(new i.default(t,n.point)),t=n.point;break;case a.MoveTo:t=n.point}return this.cachedGeometry=e,this.cachedGeometry}static computeBBoxForSegment(t,e){const n=[t];let r;switch(e.kind){case a.MoveTo:case a.LineTo:n.push(e.point);break;case a.CubicBezierTo:n.push(e.controlPoint1,e.controlPoint2,e.endPoint);break;case a.QuadraticBezierTo:n.push(e.controlPoint,e.endPoint);break;default:return r=e,r}return o.default.bboxOf(n)}intersection(t){const e=[];for(const n of this.geometry)if(n instanceof i.default){const r=n.intersection(t);r&&e.push({curve:n,parameterValue:r.t,point:r.point})}else{const r=n.intersects(t).map((e=>{"string"==typeof e&&(e=parseFloat(e));const r=s.Vec2.ofXY(n.get(e));return r.minus(t.p1).magnitude()>t.length||r.minus(t.p2).magnitude()>t.length?null:{point:r,parameterValue:e,curve:n}})).filter((t=>null!==t));e.push(...r)}return e}transformedBy(t){const e=t.transformVec2(this.startPoint),n=[];let r;for(const e of this.parts)switch(e.kind){case a.MoveTo:case a.LineTo:n.push({kind:e.kind,point:t.transformVec2(e.point)});break;case a.CubicBezierTo:n.push({kind:e.kind,controlPoint1:t.transformVec2(e.controlPoint1),controlPoint2:t.transformVec2(e.controlPoint2),endPoint:t.transformVec2(e.endPoint)});break;case a.QuadraticBezierTo:n.push({kind:e.kind,controlPoint:t.transformVec2(e.controlPoint),endPoint:t.transformVec2(e.endPoint)});break;default:return r=e,r}return new l(e,n)}union(t){return t?new l(this.startPoint,[...this.parts,{kind:a.MoveTo,point:t.startPoint},...t.parts]):this}static fromRenderable(t){return new l(t.startPoint,t.commands)}toRenderable(t){return{startPoint:this.startPoint,style:t,commands:this.parts}}toString(){return l.toString(this.startPoint,this.parts)}static toString(t,e){const n=[],r=t=>{let e=t.toString();if(-1===e.indexOf("."))return e;const n=/^([-]?)(\d*)\.(\d*9{4,}\d)$/.exec(e);if(n){const t=n[1],r=parseInt(e.charAt(e.length-1),10),i=parseInt(n[3],10),o=parseInt(n[2],10);let s=(i+10-r).toString(),a=0;s.length>i.toString().length&&(s=s.substring(1),a=1),e=`${t+(o+a).toString()}.${s}`}return e=e.replace(/^([-]?\d*\.?\d*[1-9.])0{4,}\d$/,"$1"),e.replace(/[.]$/,"")},i=(t,...e)=>{const i=[];for(const t of e){const e=r(t.x),n=r(t.y);i.push(`${e},${n}`)}n.push(`${t}${i.join(" ")}`)};let o;i("M",t);for(const t of e)switch(t.kind){case a.MoveTo:i("M",t.point);break;case a.LineTo:i("L",t.point);break;case a.CubicBezierTo:i("C",t.controlPoint1,t.controlPoint2,t.endPoint);break;case a.QuadraticBezierTo:i("Q",t.controlPoint,t.endPoint);break;default:return o=t,o}return n.join("")}static fromString(t){t=t.split("\n").join(" ");let e=s.Vec2.zero,n=null;const r=[],i=t=>{r.push({kind:a.LineTo,point:t})},o=/([MmZzLlHhVvCcSsQqTtAa])\s*([^a-zA-Z]*)/g;let c;for(;null!==(c=o.exec(t));){const t=c[2].trim().split(/[^0-9.-]/).filter((t=>t.length>0)).map((t=>parseFloat(t))),o=c[1],l=o!==o.toLowerCase(),g=t.reduce(((t,e,n,r)=>{if(n%2!=0){const i=e,o=r[n-1];return t.concat(s.Vec2.of(o,i))}return t}),[]).map((t=>l?(e=t,t):(e=e.plus(t),e)));let v;switch(o.toLowerCase()){case"m":v=1,m=g[0],r.push({kind:a.MoveTo,point:m});break;case"l":v=1,i(g[0]);break;case"z":v=0,n&&i(n);break;case"c":v=3,u=g[0],p=g[1],f=g[2],r.push({kind:a.CubicBezierTo,controlPoint1:u,controlPoint2:p,endPoint:f});break;case"q":v=2,h=g[0],d=g[1],r.push({kind:a.QuadraticBezierTo,controlPoint:h,endPoint:d});break;case"h":v=0,i(l?s.Vec2.of(t[0],e.y):e.plus(s.Vec2.of(t[0],0)));break;case"v":v=0,i(l?s.Vec2.of(e.x,t[1]):e.plus(s.Vec2.of(0,t[1])));break;default:throw new Error(`Unknown path command ${o}`)}if(g.length!==v)throw new Error(`\n\t\t\t\t\tIncorrect number of arguments: got ${JSON.stringify(g)} with a length of ${g.length}  ${v}.\n\t\t\t\t`.trim());g.length>0&&(null!=n||(n=g[0]))}var h,d,u,p,f,m;return new l(null!=n?n:s.Vec2.zero,r)}}e.default=l},417:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(412),i=n(652);class o{constructor(t,e,n,r){this.x=t,this.y=e,this.w=n,this.h=r,n<0&&(this.x+=n,this.w=Math.abs(n)),r<0&&(this.y+=r,this.h=Math.abs(r)),this.topLeft=i.Vec2.of(this.x,this.y),this.size=i.Vec2.of(this.w,this.h),this.bottomRight=this.topLeft.plus(this.size),this.center=this.topLeft.plus(this.size.times(.5)),this.area=this.w*this.h}translatedBy(t){return new o(t.x+this.x,t.y+this.y,this.w,this.h)}resizedTo(t){return new o(this.x,this.y,t.x,t.y)}containsPoint(t){return this.x<=t.x&&this.y<=t.y&&this.x+this.w>=t.x&&this.y+this.h>=t.y}containsRect(t){return this.x<=t.x&&this.y<=t.y&&this.bottomRight.x>=t.bottomRight.x&&this.bottomRight.y>=t.bottomRight.y}intersects(t){return null!==this.intersection(t)}intersection(t){const e=this.topLeft.zip(t.topLeft,Math.max),n=this.bottomRight.zip(t.bottomRight,Math.min);return this.containsPoint(e)&&this.containsPoint(n)&&t.containsPoint(e)&&t.containsPoint(n)?o.fromCorners(e,n):null}union(t){const e=this.topLeft.zip(t.topLeft,Math.min),n=this.bottomRight.zip(t.bottomRight,Math.max);return o.fromCorners(e,n)}grownToPoint(t,e=0){const n=new o(t.x-e,t.y-e,2*e,2*e);return this.union(n)}grownBy(t){return new o(this.x-t,this.y-t,this.w+2*t,this.h+2*t)}get corners(){return[this.bottomRight,this.topRight,this.topLeft,this.bottomLeft]}get maxDimension(){return Math.max(this.w,this.h)}get topRight(){return this.bottomRight.plus(i.Vec2.of(0,-this.h))}get bottomLeft(){return this.topLeft.plus(i.Vec2.of(0,this.h))}getEdges(){const t=this.corners;return[new r.default(t[0],t[1]),new r.default(t[1],t[2]),new r.default(t[2],t[3]),new r.default(t[3],t[0])]}transformedBoundingBox(t){return o.bboxOf(this.corners.map((e=>t.transformVec2(e))))}eq(t,e=0){return this.topLeft.eq(t.topLeft,e)&&this.size.eq(t.size,e)}toString(){return`Rect(point(${this.x}, ${this.y}), size(${this.w}, ${this.h}))`}static fromCorners(t,e){return new o(Math.min(t.x,e.x),Math.min(t.y,e.y),Math.abs(t.x-e.x),Math.abs(t.y-e.y))}static bboxOf(t,e=0){let n=0,r=0,s=0,a=0,l=!0;for(const e of t)l&&(n=e.x,r=e.y,s=e.x,a=e.y,l=!1),n=Math.min(n,e.x),r=Math.min(r,e.y),s=Math.max(s,e.x),a=Math.max(a,e.y);return o.fromCorners(i.Vec2.of(n-e,r-e),i.Vec2.of(s+e,a+e))}static of(t){var e,n,r,i;const s=null!==(n=null!==(e=t.width)&&void 0!==e?e:t.w)&&void 0!==n?n:0,a=null!==(i=null!==(r=t.height)&&void 0!==r?r:t.h)&&void 0!==i?i:0;return new o(t.x,t.y,s,a)}}e.default=o,o.empty=new o(0,0,0,0),o.unitSquare=new o(0,0,1,1)},652:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vec2=void 0;const r=n(8);!function(t){t.of=(t,e)=>r.default.of(t,e,0),t.ofXY=({x:t,y:e})=>r.default.of(t,e,0),t.unitX=t.of(1,0),t.unitY=t.of(0,1),t.zero=t.of(0,0)}(e.Vec2||(e.Vec2={}))},8:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(t,e,n){this.x=t,this.y=e,this.z=n}get xy(){return{x:this.x,y:this.y}}static of(t,e,r){return new n(t,e,r)}at(t){if(0===t)return this.x;if(1===t)return this.y;if(2===t)return this.z;throw new Error(`${t} out of bounds!`)}magnitude(){return Math.sqrt(this.dot(this))}magnitudeSquared(){return this.dot(this)}angle(){return Math.atan2(this.y,this.x)}normalized(){const t=this.magnitude();return n.of(this.x/t,this.y/t,this.z/t)}times(t){return n.of(this.x*t,this.y*t,this.z*t)}plus(t){return n.of(this.x+t.x,this.y+t.y,this.z+t.z)}minus(t){return this.plus(t.times(-1))}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return n.of(this.y*t.z-t.y*this.z,t.x*this.z-this.x*t.z,this.x*t.y-t.x*this.y)}extend(t,e){return this.plus(e.normalized().times(t))}lerp(t,e){return this.times(1-e).plus(t.times(e))}zip(t,e){return n.of(e(t.x,this.x),e(t.y,this.y),e(t.z,this.z))}map(t){return n.of(t(this.x),t(this.y),t(this.z))}asArray(){return[this.x,this.y,this.z]}eq(t,e){for(let n=0;n<3;n++)if(Math.abs(t.at(n)-this.at(n))>e)return!1;return!0}toString(){return`Vec(${this.x}, ${this.y}, ${this.z})`}}e.default=n,n.unitX=n.of(1,0,0),n.unitY=n.of(0,1,0),n.unitZ=n.of(0,0,1),n.zero=n.of(0,0,0)},367:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(781),i=n(417),o=n(652);e.default=class{constructor(t){this.viewport=t,this.objectLevel=0,this.currentPaths=null}flushPath(){if(!this.currentPaths)return;let t=null;for(const c of this.currentPaths){const{startPoint:h,commands:d,style:u}=c;t&&(i=void 0,o=void 0,s=void 0,a=void 0,l=void 0,(e=t)===(n=u)||e.fill.eq(n.fill)&&(null===(o=null===(i=e.stroke)||void 0===i?void 0:i.color)||void 0===o?void 0:o.eq(null===(s=n.stroke)||void 0===s?void 0:s.color))&&(null===(a=e.stroke)||void 0===a?void 0:a.width)===(null===(l=n.stroke)||void 0===l?void 0:l.width))?this.moveTo(h):(t&&this.endPath(t),this.beginPath(h),t=u);for(const t of d)t.kind===r.PathCommandType.LineTo?this.lineTo(t.point):t.kind===r.PathCommandType.MoveTo?this.moveTo(t.point):t.kind===r.PathCommandType.CubicBezierTo?this.traceCubicBezierCurve(t.controlPoint1,t.controlPoint2,t.endPoint):t.kind===r.PathCommandType.QuadraticBezierTo&&this.traceQuadraticBezierCurve(t.controlPoint,t.endPoint)}var e,n,i,o,s,a,l;t&&this.endPath(t)}drawPath(t){0===this.objectLevel?(this.currentPaths=[t],this.flushPath(),this.currentPaths=null):this.currentPaths.push(t)}drawRect(t,e,n){const s=[],a=o.Vec2.of(e,e).times(.5),l=i.default.fromCorners(t.topLeft.plus(a),t.bottomRight.minus(a)),c=i.default.fromCorners(t.topLeft.minus(a),t.bottomRight.plus(a)),h=[l.corners[3],...l.corners,...c.corners.reverse()];for(const t of h)s.push({kind:r.PathCommandType.LineTo,point:t});this.drawPath({startPoint:c.corners[3],commands:s,style:n})}startObject(t){this.currentPaths=[],this.objectLevel++}endObject(){if(this.flushPath(),this.currentPaths=null,this.objectLevel--,this.objectLevel<0)throw new Error("More objects have ended than have been started (negative object nesting level)!")}}},929:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(813),i=n(652),o=n(367);class s extends o.default{constructor(t,e){super(e),this.ctx=t}displaySize(){return i.Vec2.of(this.ctx.canvas.clientWidth,this.ctx.canvas.clientHeight)}clear(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}beginPath(t){t=this.viewport.canvasToScreen(t),this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y)}endPath(t){this.ctx.fillStyle=t.fill.toHexString(),this.ctx.fill(),t.stroke&&(this.ctx.strokeStyle=t.stroke.color.toHexString(),this.ctx.lineWidth=this.viewport.getScaleFactor()*t.stroke.width,this.ctx.stroke()),this.ctx.closePath()}lineTo(t){t=this.viewport.canvasToScreen(t),this.ctx.lineTo(t.x,t.y)}moveTo(t){t=this.viewport.canvasToScreen(t),this.ctx.moveTo(t.x,t.y)}traceCubicBezierCurve(t,e,n){t=this.viewport.canvasToScreen(t),e=this.viewport.canvasToScreen(e),n=this.viewport.canvasToScreen(n);const r=e.minus(t),i=n.minus(e);r.magnitudeSquared()<25&&i.magnitudeSquared()<25?this.ctx.lineTo(n.x,n.y):this.ctx.bezierCurveTo(t.x,t.y,e.x,e.y,n.x,n.y)}traceQuadraticBezierCurve(t,e){t=this.viewport.canvasToScreen(t),e=this.viewport.canvasToScreen(e);t.minus(e).magnitudeSquared()<25?this.ctx.lineTo(e.x,e.y):this.ctx.quadraticCurveTo(t.x,t.y,e.x,e.y)}drawPoints(...t){for(let e=0;e<t.length;e++){const n=this.viewport.canvasToScreen(t[e]);this.ctx.beginPath(),this.ctx.arc(n.x,n.y,10,0,2*Math.PI),this.ctx.fillStyle=r.default.ofRGBA(.5+Math.sin(e)/2,1,.5+Math.cos(.2*e)/4,.5).toHexString(),this.ctx.fill(),this.ctx.stroke(),this.ctx.closePath(),this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.ctx.fillText(`${e}`,n.x,n.y,20)}}}e.default=s},988:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(652),i=n(367);class o extends i.default{constructor(t){super(t),this.clearedCount=0,this.renderedPathCount=0,this.lastFillStyle=null,this.lastPoint=null,this.objectNestingLevel=0,this.pointBuffer=[]}displaySize(){return r.Vec2.of(640,480)}clear(){if(this.clearedCount++,this.renderedPathCount=0,this.pointBuffer=[],this.objectNestingLevel>0)throw new Error(`Within an object while clearing! Nesting level: ${this.objectNestingLevel}`)}beginPath(t){this.lastPoint=t,this.pointBuffer.push(t)}endPath(t){this.renderedPathCount++,this.lastFillStyle=t}lineTo(t){this.lastPoint=t,this.pointBuffer.push(t)}moveTo(t){this.lastPoint=t,this.pointBuffer.push(t)}traceCubicBezierCurve(t,e,n){this.lastPoint=n,this.pointBuffer.push(t,e,n)}traceQuadraticBezierCurve(t,e){this.lastPoint=e,this.pointBuffer.push(t,e)}drawPoints(...t){}startObject(t){super.startObject(t),this.objectNestingLevel+=1}endObject(){super.endObject(),this.objectNestingLevel-=1}}e.default=o},239:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(781),i=n(652),o=n(367),s="http://www.w3.org/2000/svg";class a extends o.default{constructor(t,e){super(e),this.elem=t,this.clear()}displaySize(){return i.Vec2.of(this.elem.clientWidth,this.elem.clientHeight)}clear(){this.mainGroup=document.createElementNS(s,"g"),this.elem.replaceChildren(this.mainGroup)}beginPath(t){var e;this.currentPath=[],this.pathStart=this.viewport.canvasToScreen(t),null!==(e=this.lastPathStart)&&void 0!==e||(this.lastPathStart=this.pathStart)}endPath(t){var e;t.fill.eq(null===(e=this.lastPathStyle)||void 0===e?void 0:e.fill)?(this.lastPath.push({kind:r.PathCommandType.MoveTo,point:this.pathStart},...this.currentPath),this.pathStart=null,this.currentPath=null):(this.addPathToSVG(),this.lastPathStart=this.pathStart,this.lastPathStyle=t,this.lastPath=this.currentPath,this.pathStart=null,this.currentPath=null)}addPathToSVG(){if(!this.lastPathStyle||!this.lastPath)return;const t=document.createElementNS(s,"path");t.setAttribute("d",r.default.toString(this.lastPathStart,this.lastPath));const e=this.lastPathStyle;t.setAttribute("fill",e.fill.toHexString()),this.lastPathStyle.stroke&&(t.setAttribute("stroke",e.stroke.color.toHexString()),t.setAttribute("stroke-width",e.stroke.width.toString())),this.mainGroup.appendChild(t)}startObject(t){super.startObject(t),this.lastPath=null,this.lastPathStart=null,this.lastPathStyle=null}endObject(){super.endObject(),this.addPathToSVG()}lineTo(t){t=this.viewport.canvasToScreen(t),this.currentPath.push({kind:r.PathCommandType.LineTo,point:t})}moveTo(t){t=this.viewport.canvasToScreen(t),this.currentPath.push({kind:r.PathCommandType.MoveTo,point:t})}traceCubicBezierCurve(t,e,n){t=this.viewport.canvasToScreen(t),e=this.viewport.canvasToScreen(e),n=this.viewport.canvasToScreen(n),this.currentPath.push({kind:r.PathCommandType.CubicBezierTo,controlPoint1:t,controlPoint2:e,endPoint:n})}traceQuadraticBezierCurve(t,e){t=this.viewport.canvasToScreen(t),e=this.viewport.canvasToScreen(e),this.currentPath.push({kind:r.PathCommandType.QuadraticBezierTo,controlPoint:t,endPoint:e})}drawPoints(...t){t.map((t=>{const e=document.createElementNS(s,"circle");e.setAttribute("cx",`${t.x}`),e.setAttribute("cy",`${t.y}`),e.setAttribute("r","15"),this.mainGroup.appendChild(e)}))}drawSVGElem(t){this.elem.appendChild(t.cloneNode(!0))}}e.default=a},639:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(700),i=n(624);n(819),n(457);const o=n(629),s=n(813),a=n(140),l=n(970),c=n(643),h="\n\tstyle='fill: var(--primary-foreground-color);'\n",d="\n\tstyle='fill: var(--primary-foreground-color); stroke: var(--primary-foreground-color);'\n";class u{constructor(t,e,n){this.editor=t,this.targetTool=e,this.localizationTable=n,this.container=document.createElement("div"),this.container.classList.add("toolbar-toolContainer"),this.dropdownContainer=document.createElement("div"),this.dropdownContainer.classList.add("toolbar-dropdown"),this.dropdownContainer.classList.add("hidden"),this.hasDropdown=!1,this.button=document.createElement("div"),this.button.classList.add("toolbar-button"),this.label=document.createElement("label"),this.button.setAttribute("role","button"),this.button.tabIndex=0,this.button.onclick=()=>{this.handleClick()},t.notifier.on(i.EditorEventType.ToolEnabled,(t=>{if(t.kind!==i.EditorEventType.ToolEnabled)throw new Error("Incorrect event type! (Expected ToolEnabled)");t.tool===e&&this.updateSelected(!0)})),t.notifier.on(i.EditorEventType.ToolDisabled,(t=>{if(t.kind!==i.EditorEventType.ToolDisabled)throw new Error("Incorrect event type! (Expected ToolDisabled)");t.tool===e&&(this.updateSelected(!1),this.setDropdownVisible(!1))}))}handleClick(){this.hasDropdown?this.targetTool.isEnabled()?this.setDropdownVisible(!this.isDropdownVisible()):this.targetTool.setEnabled(!0):this.targetTool.setEnabled(!this.targetTool.isEnabled())}addTo(t){this.label.innerText=this.getTitle(),this.icon=null,this.updateIcon(),this.updateSelected(this.targetTool.isEnabled()),this.button.replaceChildren(this.icon,this.label),this.container.appendChild(this.button),this.hasDropdown=this.fillDropdown(this.dropdownContainer),this.hasDropdown&&(this.dropdownIcon=this.createDropdownIcon(),this.button.appendChild(this.dropdownIcon),this.container.appendChild(this.dropdownContainer)),this.setDropdownVisible(!1),t.appendChild(this.container)}updateIcon(){var t;const e=this.createIcon();null===(t=this.icon)||void 0===t||t.replaceWith(e),this.icon=e,this.icon.classList.add("toolbar-icon")}updateSelected(t){t?this.container.classList.add("selected"):this.container.classList.remove("selected")}setDropdownVisible(t){t?(this.dropdownContainer.classList.remove("hidden"),this.container.classList.add("dropdownVisible")):(this.dropdownContainer.classList.add("hidden"),this.container.classList.remove("dropdownVisible"))}isDropdownVisible(){return!this.dropdownContainer.classList.contains("hidden")}createDropdownIcon(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.innerHTML=`\n\t\t<g>\n\t\t\t<path\n\t\t\t\td='M5,10 L50,90 L95,10 Z'\n\t\t\t\t${h}\n\t\t\t/>\n\t\t</g>\n\t\t`,t.classList.add("toolbar-showHideDropdownIcon"),t.setAttribute("viewBox","0 0 100 100"),t}}class p extends u{getTitle(){return this.localizationTable.eraser}createIcon(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.innerHTML=`\n\t\t<g>\n\t\t\t<rect x=10 y=50 width=80 height=30 rx=10 fill='pink' />\n\t\t\t<rect\n\t\t\t\tx=10 y=10 width=80 height=50\n\t\t\t\t${h}\n\t\t\t/>\n\t\t</g>\n\t\t`,t.setAttribute("viewBox","0 0 100 100"),t}fillDropdown(t){return!1}}class f extends u{constructor(t,e,n){super(t,e,n),this.tool=e}getTitle(){return this.localizationTable.select}createIcon(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.innerHTML="\n\t\t<g>\n\t\t\t<rect x=10 y=10 width=70 height=70 fill='pink' stroke='black'/>\n\t\t\t<rect x=75 y=75 width=10 height=10 fill='white' stroke='black'/>\n\t\t</g>\n\t\t",t.setAttribute("viewBox","0 0 100 100"),t}fillDropdown(t){const e=document.createElement("div"),n=document.createElement("button");return n.innerText=this.localizationTable.resizeImageToSelection,n.disabled=!0,n.onclick=()=>{const t=this.tool.getSelection();this.editor.dispatch(this.editor.setImportExportRect(t.region))},this.editor.notifier.on(i.EditorEventType.ToolUpdated,(t=>{if(t.kind!==i.EditorEventType.ToolUpdated)throw new Error("Invalid event type!");if(t.tool===this.tool){const t=this.tool.getSelection().region.area>0;n.disabled=!t}})),e.replaceChildren(n),t.appendChild(e),!0}}class m extends u{getTitle(){return this.localizationTable.touchDrawing}createIcon(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.innerHTML=`\n\t\t<g>\n\t\t\t<path d='M11,-30 Q0,10 20,20 Q40,20 40,-30 Z' fill='blue' stroke='black'/>\n\t\t\t<path d='\n\t\t\t\tM0,90 L0,50 Q5,40 10,50\n\t\t\t\tL10,20 Q20,15 30,20\n\t\t\t\tL30,50 Q50,40 80,50\n\t\t\t\tL80,90 L10,90 Z'\n\t\t\t\t\n\t\t\t\t${d}\n\t\t\t/>\n\t\t</g>\n\t\t`,t.setAttribute("viewBox","-10 -30 100 100"),t}fillDropdown(t){return!1}updateSelected(t){t?this.container.classList.remove("selected"):this.container.classList.add("selected")}}class g extends u{constructor(t,e,n){super(t,e,n),this.tool=e,this.updateInputs=()=>{},this.editor.notifier.on(i.EditorEventType.ToolUpdated,(t=>{if(t.kind!==i.EditorEventType.ToolUpdated)throw new Error("Invalid event type!");t.tool===this.tool&&(this.updateIcon(),this.updateInputs())}))}getTitle(){return this.localizationTable.pen}createIcon(){const t=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=Math.round(2*Math.sqrt(this.tool.getThickness())),n=this.tool.getColor(),r=`M14,63 L${50-e},95 L${50+e},90 L88,60 Z`,i=`M14,63 L${50-e},85 L${50+e},83 L88,60 Z`;return t.innerHTML=`\n\t\t<defs>\n\t\t\t<pattern\n\t\t\t\tid='checkerboard'\n\t\t\t\tviewBox='0,0,10,10'\n\t\t\t\twidth='20%'\n\t\t\t\theight='20%'\n\t\t\t\tpatternUnits='userSpaceOnUse'\n\t\t\t>\n\t\t\t\t<rect x=0 y=0 width=10 height=10 fill='white'/>\n\t\t\t\t<rect x=0 y=0 width=5 height=5 fill='gray'/>\n\t\t\t\t<rect x=5 y=5 width=5 height=5 fill='gray'/>\n\t\t\t</pattern>\n\t\t</defs>\n\t\t<g>\n\t\t\t\x3c!-- Pen grip --\x3e\n\t\t\t<path\n\t\t\t\td='M10,10 L90,10 L90,60 L${50+e},80 L${50-e},80 L10,60 Z'\n\t\t\t\t${d}\n\t\t\t/>\n\t\t</g>\n\t\t<g>\n\t\t\t\x3c!-- Checkerboard background for slightly transparent pens --\x3e\n\t\t\t<path d='${i}' fill='url(#checkerboard)'/>\n\n\t\t\t\x3c!-- Actual pen tip --\x3e\n\t\t\t<path\n\t\t\t\td='${r}'\n\t\t\t\tfill='${n.toHexString()}'\n\t\t\t\tstroke='${n.toHexString()}'\n\t\t\t/>\n\t\t</g>\n\t\t`,t.setAttribute("viewBox","0 0 100 100"),t}fillDropdown(t){const e=document.createElement("div"),n=document.createElement("div"),r=document.createElement("label"),i=document.createElement("input");i.id="toolbar-thicknessInput"+g.idCounter++,r.innerText=this.localizationTable.thicknessLabel,r.setAttribute("for",i.id),i.type="range",i.min="1",i.max="20",i.step="1",i.oninput=()=>{this.tool.setThickness(Math.pow(parseFloat(i.value),2))},n.appendChild(r),n.appendChild(i);const o=document.createElement("div"),a=document.createElement("label"),l=document.createElement("input");return l.id="toolbar-colorInput"+g.idCounter++,a.innerText=this.localizationTable.colorLabel,a.setAttribute("for",l.id),l.className="coloris_input",l.type="button",l.oninput=()=>{this.tool.setColor(s.default.fromHex(l.value))},o.appendChild(a),o.appendChild(l),this.updateInputs=()=>{l.value=this.tool.getColor().toHexString(),i.value=Math.sqrt(this.tool.getThickness()).toString()},this.updateInputs(),e.replaceChildren(o,n),t.replaceChildren(e),!0}}g.idCounter=0;class v{constructor(t,e,n=v.defaultLocalization){this.editor=t,this.localizationTable=n,this.container=document.createElement("div"),this.container.classList.add("toolbar-root"),this.addElements(),e.appendChild(this.container),(0,o.init)(),(0,o.coloris)({el:".coloris_input",format:"hex",selectInput:!1,focusInput:!1,themeMode:this.editor.lightMode?"light":"dark",swatches:[s.default.red.toHexString(),s.default.purple.toHexString(),s.default.blue.toHexString(),s.default.clay.toHexString(),s.default.black.toHexString(),s.default.white.toHexString()]})}addActionButton(t,e,n){const r=document.createElement("button");return r.innerText=t,r.classList.add("toolbar-toolButton"),r.onclick=e,(null!=n?n:this.container).appendChild(r),r}addUndoRedoButtons(){const t=document.createElement("div");t.classList.add("toolbar-buttonGroup");const e=this.addActionButton("Undo",(()=>{this.editor.history.undo()}),t),n=this.addActionButton("Redo",(()=>{this.editor.history.redo()}),t);this.container.appendChild(t),e.disabled=!0,n.disabled=!0,this.editor.notifier.on(i.EditorEventType.UndoRedoStackUpdated,(t=>{if(t.kind!==i.EditorEventType.UndoRedoStackUpdated)throw new Error("Wrong event type!");e.disabled=0===t.undoStackSize,n.disabled=0===t.redoStackSize}))}addElements(){const t=this.editor.toolController;for(const e of t.getMatchingTools(r.ToolType.Pen)){if(!(e instanceof a.default))throw new Error("All `Pen` tools must have kind === ToolType.Pen");new g(this.editor,e,this.localizationTable).addTo(this.container)}for(const e of t.getMatchingTools(r.ToolType.Eraser)){if(!(e instanceof l.default))throw new Error("All Erasers must have kind === ToolType.Eraser!");new p(this.editor,e,this.localizationTable).addTo(this.container)}for(const e of t.getMatchingTools(r.ToolType.Selection)){if(!(e instanceof c.default))throw new Error("All SelectionTools must have kind === ToolType.Selection");new f(this.editor,e,this.localizationTable).addTo(this.container)}for(const e of t.getMatchingTools(r.ToolType.TouchPanZoom))new m(this.editor,e,this.localizationTable).addTo(this.container);this.addUndoRedoButtons()}}e.default=v,v.defaultLocalization={pen:"Pen",eraser:"Eraser",select:"Select",touchDrawing:"Touch Drawing",thicknessLabel:"Thickness: ",colorLabel:"Color: ",resizeImageToSelection:"Resize image to selection",undo:"Undo",redo:"Redo"}},597:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(624);e.default=class{constructor(t){this.notifier=t,this.enabled=!0,this.group=null}onWheel(t){return!1}onKeyPress(t){return!1}setEnabled(t){var e;this.enabled=t,t?(null===(e=this.group)||void 0===e||e.notifyEnabled(this),this.notifier.dispatch(r.EditorEventType.ToolEnabled,{kind:r.EditorEventType.ToolEnabled,tool:this})):this.notifier.dispatch(r.EditorEventType.ToolDisabled,{kind:r.EditorEventType.ToolDisabled,tool:this})}isEnabled(){return this.enabled}setToolGroup(t){this.isEnabled()&&t.notifyEnabled(this),this.group=t}}},970:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(597),i=n(412),o=n(663),s=n(700);class a extends r.default{constructor(t){super(t.notifier),this.editor=t,this.kind=s.ToolType.Eraser}onPointerDown(t){return 1===t.allPointers.length&&(this.lastPoint=t.current.canvasPos,this.toRemove=[],!0)}onPointerMove(t){var e;const n=t.current.canvasPos;if(0===n.minus(this.lastPoint).magnitude())return;const r=new i.default(this.lastPoint,n),s=r.bbox;this.toRemove.push(...this.editor.image.getElementsIntersectingRegion(s).filter((t=>t.intersects(r)))),null===(e=this.command)||void 0===e||e.unapply(this.editor),this.command=new o.default(this.toRemove),this.command.apply(this.editor),this.lastPoint=n}onPointerUp(t){var e;this.command&&this.toRemove.length>0&&(null===(e=this.command)||void 0===e||e.unapply(this.editor),this.editor.dispatch(this.command)),this.command=null}onGestureCancel(){var t;null===(t=this.command)||void 0===t||t.unapply(this.editor),this.command=null}}e.default=a},231:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PanZoomMode=void 0;const r=n(270),i=n(652),o=n(8),s=n(168),a=n(355),l=n(597),c=n(700);var h;!function(t){t[t.OneFingerGestures=1]="OneFingerGestures",t[t.TwoFingerGestures=2]="TwoFingerGestures",t[t.AnyDevice=4]="AnyDevice"}(h=e.PanZoomMode||(e.PanZoomMode={}));class d extends l.default{constructor(t,e){super(t.notifier),this.editor=t,this.mode=e,this.kind=c.ToolType.PanZoom,e===h.OneFingerGestures&&(this.kind=c.ToolType.TouchPanZoom)}computePinchData(t,e){const n=e.screenPos.minus(t.screenPos),r=n.angle(),i=n.magnitude();return{canvasCenter:e.canvasPos.plus(t.canvasPos).times(.5),screenCenter:e.screenPos.plus(t.screenPos).times(.5),angle:r,dist:i}}pointersHaveCorrectDeviceType(t){return this.mode&h.AnyDevice||t.every((t=>t.device===s.PointerDevice.Touch))}onPointerDown({allPointers:t}){var e;let n;if(this.pointersHaveCorrectDeviceType(t))if(2===t.length&&this.mode&h.TwoFingerGestures){const{screenCenter:e,angle:r,dist:i}=this.computePinchData(t[0],t[1]);this.lastAngle=r,this.lastDist=i,this.lastScreenCenter=e,n=!0}else 1===t.length&&this.mode&h.OneFingerGestures&&(this.lastScreenCenter=t[0].screenPos,n=!0);else n=!1;return n&&(null!==(e=this.transform)&&void 0!==e||(this.transform=new a.Viewport.ViewportTransform(r.default.identity))),n}getCenterDelta(t){return this.editor.viewport.screenToCanvasTransform.transformVec3(t.minus(this.lastScreenCenter))}handleTwoFingerMove(t){const{screenCenter:e,canvasCenter:n,angle:i,dist:o}=this.computePinchData(t[0],t[1]),s=this.getCenterDelta(e),l=r.default.translation(s).rightMul(r.default.scaling2D(o/this.lastDist,n)).rightMul(r.default.zRotation(i-this.lastAngle,n));this.lastScreenCenter=e,this.lastDist=o,this.lastAngle=i,this.transform=new a.Viewport.ViewportTransform(this.transform.transform.rightMul(l))}handleOneFingerMove(t){const e=this.getCenterDelta(t.screenPos);this.transform=new a.Viewport.ViewportTransform(this.transform.transform.rightMul(r.default.translation(e))),this.lastScreenCenter=t.screenPos}onPointerMove({allPointers:t}){var e;null!==(e=this.transform)&&void 0!==e||(this.transform=new a.Viewport.ViewportTransform(r.default.identity));const n=this.transform;2===t.length&&this.mode&h.TwoFingerGestures?this.handleTwoFingerMove(t):1===t.length&&this.mode&h.OneFingerGestures&&this.handleOneFingerMove(t[0]),n.unapply(this.editor),this.transform.apply(this.editor)}onPointerUp(t){this.transform=null}onGestureCancel(){var t;null===(t=this.transform)||void 0===t||t.unapply(this.editor),this.transform=null}updateTransform(t){var e;let n=t;this.transform&&(n=this.transform.transform.rightMul(t)),null===(e=this.transform)||void 0===e||e.unapply(this.editor),this.transform=new a.Viewport.ViewportTransform(n),this.transform.apply(this.editor)}onWheel({delta:t,screenPos:e}){null===this.transform&&(this.transform=new a.Viewport.ViewportTransform(r.default.identity));const n=this.editor.viewport.screenToCanvas(e),i=this.editor.viewport.screenToCanvasTransform.transformVec3(o.default.of(-t.x,-t.y,0)),s=r.default.scaling2D(Math.pow(1.04,-t.z),n).rightMul(r.default.translation(i));return this.updateTransform(s),!0}onKeyPress({key:t}){let e=i.Vec2.zero,n=1,o=0;switch(t){case"a":case"h":case"ArrowLeft":e=i.Vec2.of(-1,0);break;case"d":case"l":case"ArrowRight":e=i.Vec2.of(1,0);break;case"k":case"ArrowUp":e=i.Vec2.of(0,-1);break;case"j":case"ArrowDown":e=i.Vec2.of(0,1);break;case"w":n=.5;break;case"s":n=2;break;case"r":o=1;break;case"R":o=-1;break;default:return!1}e=e.times(30),o*=Math.PI/8,e=e.times(-1),o*=-1,n=1/n;e=this.editor.viewport.screenToCanvasTransform.transformVec3(e);const s=this.editor.viewport.visibleRect.center,a=r.default.scaling2D(n,s).rightMul(r.default.zRotation(o,s)).rightMul(r.default.translation(e));return this.updateTransform(a),!0}}e.default=d},140:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(813),i=n(220),o=n(652),s=n(168),a=n(995),l=n(624),c=n(597),h=n(700);class d extends c.default{constructor(t,e=r.default.purple,n=16){super(t.notifier),this.editor=t,this.color=e,this.thickness=n,this.kind=h.ToolType.Pen}getPressureMultiplier(){return 1/this.editor.viewport.getScaleFactor()*this.thickness}getStrokePoint(t){var e;const n=Math.max(null!==(e=t.pressure)&&void 0!==e?e:1,.3);return{pos:t.canvasPos,width:n*this.getPressureMultiplier(),color:this.color,time:t.timeStamp}}addPointToStroke(t){this.builder.addPoint(this.getStrokePoint(t)),this.editor.clearWetInk(),this.editor.drawWetInk(...this.builder.preview())}onPointerDown({current:t,allPointers:e}){if(1===e.length||t.device===s.PointerDevice.Pen){const e=this.editor.viewport.screenToCanvasTransform,n=7*e.transformVec3(o.Vec2.unitX).magnitude(),r=2*e.transformVec3(o.Vec2.unitX).magnitude();return this.builder=new a.default(this.getStrokePoint(t),r,n),!0}return!1}onPointerMove({current:t}){this.addPointToStroke(t)}onPointerUp({current:t}){if(this.builder){if(this.addPointToStroke(t),this.builder&&t.isPrimary){const t=this.builder.build();this.editor.clearWetInk(),this.editor.drawWetInk(...this.builder.preview());const e=!0,n=new i.default.AddElementCommand(t,e);this.editor.dispatch(n)}this.builder=null,this.editor.clearWetInk()}}onGestureCancel(){this.editor.clearWetInk()}noteUpdated(){this.editor.notifier.dispatch(l.EditorEventType.ToolUpdated,{kind:l.EditorEventType.ToolUpdated,tool:this})}setColor(t){t.toHexString()!==this.color.toHexString()&&(this.color=t,this.noteUpdated())}setThickness(t){t!==this.thickness&&(this.thickness=t,this.noteUpdated())}getThickness(){return this.thickness}getColor(){return this.color}}e.default=d},643:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n(270),o=n(417),s=n(652),a=n(624),l=n(355),c=n(597),h=n(700),d=30,u=(t,e,n)=>{t.style.touchAction="none";let r,i,o=!1;t.addEventListener("touchstart",(t=>t.preventDefault())),t.addEventListener("pointerdown",(e=>!!e.isPrimary&&(o=!0,t.setPointerCapture(e.pointerId),r=e.pageX,i=e.pageY,!0))),t.addEventListener("pointermove",(t=>{if(t.isPrimary&&o){const n=s.Vec2.of(t.pageX-r,t.pageY-i);return e(n,s.Vec2.of(t.offsetX,t.offsetY)),r=t.pageX,i=t.pageY,!0}return!1}));const a=t=>!!t.isPrimary&&(o=!1,n(),!0);t.addEventListener("pointerup",a),t.addEventListener("pointercancel",a)};class p{constructor(t,e){this.startPoint=t,this.editor=e,this.boxRotation=this.editor.viewport.getRotationAngle(),this.selectedElems=[],this.region=o.default.bboxOf([t]),this.backgroundBox=document.createElement("div");const n=document.createElement("div"),r=document.createElement("div");this.rotateCircle=document.createElement("div");const s=document.createElement("div");this.backgroundBox.classList.add("selectionBox"),n.classList.add("draggableBackground"),r.classList.add("resizeCorner"),this.rotateCircle.classList.add("rotateCircle"),s.classList.add("rotateCircleContainer"),s.appendChild(this.rotateCircle),this.backgroundBox.appendChild(n),this.backgroundBox.appendChild(s),this.backgroundBox.appendChild(r),this.transformationCommands=[],this.transform=i.default.identity,u(n,(t=>{this.handleBackgroundDrag(t)}),(()=>this.finishDragging())),u(r,(t=>{this.handleResizeCornerDrag(t)}),(()=>this.finishDragging())),u(this.rotateCircle,((t,e)=>{this.handleRotateCircleDrag(e)}),(()=>this.finishDragging()))}handleBackgroundDrag(t){t=this.editor.viewport.screenToCanvasTransform.transformVec3(t),t=this.editor.viewport.roundPoint(t),this.region=this.region.translatedBy(t),this.transform=this.transform.rightMul(i.default.translation(t)),this.previewTransformCmds()}handleResizeCornerDrag(t){t=this.editor.viewport.screenToCanvasTransform.transformVec3(t),t=this.editor.viewport.roundPoint(t);const e=this.region.w,n=this.region.h,r=this.region.size.plus(t);if(r.y>0&&r.x>0){this.region=this.region.resizedTo(r);const t=s.Vec2.of(this.region.w/e,this.region.h/n),o=i.default.scaling2D(t,this.region.topLeft);this.transform=this.transform.rightMul(o),this.previewTransformCmds()}}handleRotateCircleDrag(t){this.boxRotation=this.boxRotation%(2*Math.PI),this.boxRotation<0&&(this.boxRotation+=2*Math.PI);let e=t.angle();e%=2*Math.PI,e<0&&(e+=2*Math.PI);let n=e-this.boxRotation;const r=Math.PI/12;if(!(Math.abs(n)<r)&&isFinite(n)){{const t=Math.sign(n);n=Math.floor(Math.abs(n)/r)*r,n*=t}this.transform=this.transform.rightMul(i.default.zRotation(n,this.region.center)),this.boxRotation+=n,this.previewTransformCmds()}}computeTransformCommands(){return this.selectedElems.map((t=>t.transformBy(this.transform)))}finishDragging(){this.transformationCommands.forEach((t=>{t.unapply(this.editor)}));const t=this.transform,e=this.transform.inverse(),n=this.boxRotation,o=this.computeTransformCommands();this.transformationCommands=[],this.transform=i.default.identity,this.region=this.region.transformedBoundingBox(e),this.editor.dispatch({apply:e=>r(this,void 0,void 0,(function*(){this.region=this.region.transformedBoundingBox(t),this.boxRotation+=n,this.updateUI(),yield e.asyncApplyCommands(o,50),this.recomputeRegion(),this.updateUI()})),unapply:t=>r(this,void 0,void 0,(function*(){this.region=this.region.transformedBoundingBox(e),this.boxRotation-=n,this.updateUI(),yield t.asyncUnapplyCommands(o,50),this.recomputeRegion(),this.updateUI()}))})}previewTransformCmds(){this.selectedElems.length>50||(this.transformationCommands.forEach((t=>t.unapply(this.editor))),this.transformationCommands=this.computeTransformCommands(),this.transformationCommands.forEach((t=>t.apply(this.editor)))),this.updateUI()}appendBackgroundBoxTo(t){this.backgroundBox.parentElement&&this.backgroundBox.remove(),t.appendChild(this.backgroundBox)}setToPoint(t){this.region=this.region.grownToPoint(t),this.recomputeBoxRotation(),this.updateUI()}cancelSelection(){this.backgroundBox.parentElement&&this.backgroundBox.remove(),this.region=o.default.empty}resolveToObjects(){if(0===this.region.w||0===this.region.h){const t=this.editor.viewport.visibleRect.maxDimension/100;this.region=o.default.bboxOf(this.region.corners,t)}return this.selectedElems=this.editor.image.getElementsIntersectingRegion(this.region).filter((t=>!!this.region.containsRect(t.getBBox())||!!this.region.getEdges().some((e=>t.intersects(e))))),!!this.recomputeRegion()&&(this.updateUI(),!0)}recomputeRegion(){const t=this.selectedElems.reduce(((t,e)=>(null!=t?t:e.getBBox()).union(e.getBBox())),null);if(!t)return this.cancelSelection(),!1;this.region=t;const e=this.getMinCanvasSize();if(this.region.w<e||this.region.h<e){const t=e/2;this.region=o.default.bboxOf(this.region.corners,t)}return this.recomputeBoxRotation(),!0}getMinCanvasSize(){return 2*(d/this.editor.viewport.getScaleFactor())}recomputeBoxRotation(){this.boxRotation=this.editor.viewport.getRotationAngle()}updateUI(){if(!this.backgroundBox)return;const t=this.region.topRight.minus(this.region.bottomRight),e=this.region.topLeft.minus(this.region.topRight),n=this.editor.viewport.canvasToScreenTransform,r=n.transformVec2(this.region.center),i=n.transformVec3(t).magnitude(),o=n.transformVec3(e).magnitude();this.backgroundBox.style.left=r.x-o/2+"px",this.backgroundBox.style.top=r.y-i/2+"px",this.backgroundBox.style.width=`${o}px`,this.backgroundBox.style.height=`${i}px`;const s=180*this.boxRotation/Math.PI;this.backgroundBox.style.transform=`rotate(${s}deg)`,this.rotateCircle.style.transform=`rotate(${-s}deg)`}}class f extends c.default{constructor(t){super(t.notifier),this.editor=t,this.kind=h.ToolType.Selection,this.handleOverlay=document.createElement("div"),t.createHTMLOverlay(this.handleOverlay),t.addStyleSheet("\n\t.handleOverlay {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t}\n\n\t.handleOverlay > .selectionBox {\n\t\tposition: fixed;\n\t\tz-index: 0;\n\t\ttransform-origin: center;\n\t}\n\n\t.handleOverlay > .selectionBox .draggableBackground {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\n\t\tbackground-color: var(--secondary-background-color);\n\t\topacity: 0.8;\n\t\tborder: 1px solid var(--primary-background-color);\n\t}\n\n\t.handleOverlay .resizeCorner {\n\t\twidth: 30px;\n\t\theight: 30px;\n\t\tmargin-right: -15px;\n\t\tmargin-bottom: -15px;\n\n\t\tposition: absolute;\n\t\tbottom: 0;\n\t\tright: 0;\n\n\t\topacity: 0.8;\n\t\tbackground-color: var(--primary-background-color);\n\t\tborder: 1px solid var(--primary-foreground-color);\n\t}\n\n\t.handleOverlay > .selectionBox .rotateCircleContainer {\n\t\tposition: absolute;\n\t\ttop: 50%;\n\t\tbottom: 50%;\n\t\tleft: 50%;\n\t\tright: 50%;\n\t}\n\n\t.handleOverlay .rotateCircle {\n\t\twidth: 30px;\n\t\theight: 30px;\n\t\tmargin-left: -15px;\n\t\tmargin-top: -15px;\n\t\topacity: 0.8;\n\n\t\tborder: 1px solid var(--primary-foreground-color);\n\t\tbackground-color: var(--primary-background-color);\n\t\tborder-radius: 100%;\n\t}\n"),this.handleOverlay.style.display="none",this.handleOverlay.classList.add("handleOverlay"),t.notifier.on(a.EditorEventType.ViewportChanged,(t=>{var e,n;null===(e=this.selectionBox)||void 0===e||e.recomputeRegion(),null===(n=this.selectionBox)||void 0===n||n.updateUI()}))}onPointerDown(t){return!(1!==t.allPointers.length||!t.current.isPrimary)&&(this.prevSelectionBox=this.selectionBox,this.selectionBox=new p(t.current.canvasPos,this.editor),this.handleOverlay.replaceChildren(),this.selectionBox.appendBackgroundBoxTo(this.handleOverlay),!0)}onPointerMove(t){this.selectionBox.setToPoint(t.current.canvasPos)}onGestureEnd(){const t=this.selectionBox.resolveToObjects();if(this.editor.notifier.dispatch(a.EditorEventType.ToolUpdated,{kind:a.EditorEventType.ToolUpdated,tool:this}),t){const t=this.editor.viewport.visibleRect,e=this.selectionBox.region,n=t.transformedBoundingBox(i.default.scaling2D(2/3,t.center));if(n.w<e.w||n.h<e.h){const t=Math.max(e.w/n.w,e.h/n.h),r=i.default.scaling2D(t,n.topLeft).inverse();new l.default.ViewportTransform(r).apply(this.editor)}if(!n.containsRect(e)){const t=e.center.minus(n.center),r=i.default.translation(t).inverse();new l.default.ViewportTransform(r).apply(this.editor)}}}onPointerUp(t){this.selectionBox.setToPoint(t.current.canvasPos),this.onGestureEnd()}onGestureCancel(){var t,e;null===(t=this.selectionBox)||void 0===t||t.cancelSelection(),this.selectionBox=this.prevSelectionBox,null===(e=this.selectionBox)||void 0===e||e.appendBackgroundBoxTo(this.handleOverlay)}setEnabled(t){super.setEnabled(t),this.handleOverlay.replaceChildren(),this.selectionBox=null,this.handleOverlay.style.display=t?"block":"none"}getSelection(){return this.selectionBox}}e.default=f},700:function(t,e,n){"use strict";var r,i,o=this&&this.__classPrivateFieldGet||function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.ToolType=void 0;const s=n(624),a=n(231),l=n(140),c=n(40),h=n(970),d=n(643),u=n(813);!function(t){t[t.TouchPanZoom=0]="TouchPanZoom",t[t.Pen=1]="Pen",t[t.Selection=2]="Selection",t[t.Eraser=3]="Eraser",t[t.PanZoom=4]="PanZoom"}(e.ToolType||(e.ToolType={}));e.default=class{constructor(t){r.add(this);const e=new c.default,n=new a.default(t,a.PanZoomMode.OneFingerGestures),i=new l.default(t),o=[new d.default(t),new h.default(t),i,new l.default(t,u.default.clay,8),new l.default(t,u.default.ofRGBA(1,1,0,.5),64)];this.tools=[n,...o,new a.default(t,a.PanZoomMode.TwoFingerGestures|a.PanZoomMode.AnyDevice)],o.forEach((t=>t.setToolGroup(e))),n.setEnabled(!1),i.setEnabled(!0),this.activeTool=null}dispatchInputEvent(t){var e,n;let r;if(t.kind===s.InputEvtType.PointerDownEvt){for(const n of this.tools)if(n.isEnabled()&&n.onPointerDown(t)){this.activeTool!==n&&(null===(e=this.activeTool)||void 0===e||e.onGestureCancel()),this.activeTool=n,r=!0;break}}else if(t.kind===s.InputEvtType.PointerUpEvt)null===(n=this.activeTool)||void 0===n||n.onPointerUp(t),this.activeTool=null,r=!0;else if(t.kind===s.InputEvtType.WheelEvt||t.kind===s.InputEvtType.KeyPressEvent){const e=t.kind===s.InputEvtType.KeyPressEvent,n=t.kind===s.InputEvtType.WheelEvt;for(const i of this.tools){if(!i.isEnabled())continue;const o=n&&i.onWheel(t);if(r=e&&i.onKeyPress(t)||o,r)break}}else if(null!==this.activeTool){let e;switch(t.kind){case s.InputEvtType.PointerMoveEvt:this.activeTool.onPointerMove(t);break;case s.InputEvtType.GestureCancelEvt:this.activeTool.onGestureCancel(),this.activeTool=null;break;default:return e=t,e}r=!0}else r=!1;return r}getMatchingTools(t){return this.tools.filter((e=>e.kind===t))}static setToolEnabled(t,e){return new class{constructor(){this.wasEnabled=null}apply(n){var s;this.wasEnabled=n.toolController.isToolEnabled(t),o(s=n.toolController,r,"m",i).call(s,t,e)}unapply(e){var n;null!==this.wasEnabled&&o(n=e.toolController,r,"m",i).call(n,t,this.wasEnabled)}}}isToolEnabled(t){return this.tools.filter((e=>e.kind===t)).some((t=>t.isEnabled()))}},r=new WeakSet,i=function(t,e){const n=this.tools.filter((e=>e.kind===t));for(const t of n)t.setEnabled(e),console.log("Set",t,"",e)}},40:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){}notifyEnabled(t){var e;t!==this.activeTool&&(null===(e=this.activeTool)||void 0===e||e.setEnabled(!1),this.activeTool=t)}}},624:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditorEventType=e.InputEvtType=void 0,function(t){t[t.PointerDownEvt=0]="PointerDownEvt",t[t.PointerMoveEvt=1]="PointerMoveEvt",t[t.PointerUpEvt=2]="PointerUpEvt",t[t.GestureCancelEvt=3]="GestureCancelEvt",t[t.WheelEvt=4]="WheelEvt",t[t.KeyPressEvent=5]="KeyPressEvent"}(e.InputEvtType||(e.InputEvtType={})),function(t){t[t.ToolEnabled=0]="ToolEnabled",t[t.ToolDisabled=1]="ToolDisabled",t[t.ToolUpdated=2]="ToolUpdated",t[t.UndoRedoStackUpdated=3]="UndoRedoStackUpdated",t[t.ObjectAdded=4]="ObjectAdded",t[t.ViewportChanged=5]="ViewportChanged",t[t.DisplayResized=6]="DisplayResized"}(e.EditorEventType||(e.EditorEventType={}))},862:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(){this.listeners={}}dispatch(t,e=null){if(!this.listeners[t])return;const n=this.listeners[t];for(let t=0;t<n.length;t++)n[t](e)}on(t,e){return this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e),{remove:()=>{const n=this.listeners[t];return this.off(t,e),n.length!==this.listeners[t].length}}}off(t,e){this.listeners[t]&&(this.listeners[t]=this.listeners[t].filter((t=>t!==e)))}}},629:(t,e)=>{var n,r,i;"undefined"!=typeof self&&self,r=[],n=function(){
/*!
  * Copyright (c) 2021 Momo Bassit.
  * Licensed under the MIT License (MIT)
  * https://github.com/mdbassit/Coloris
  */
return function(t,e,n){var r,i,o,s,a,l,c,h,d,u,p,f,m,g,v,y=e.createElement("canvas").getContext("2d"),x={r:0,g:0,b:0,h:0,s:0,v:0,a:1},b={el:"[data-coloris]",parent:"body",theme:"default",themeMode:"light",wrap:!0,margin:2,format:"hex",formatToggle:!1,swatches:[],swatchesOnly:!1,alpha:!0,forceAlpha:!1,focusInput:!0,selectInput:!1,inline:!1,defaultColor:"#000000",clearButton:!1,clearLabel:"Clear",a11y:{open:"Open color picker",close:"Close color picker",marker:"Saturation: {s}. Brightness: {v}.",hueSlider:"Hue slider",alphaSlider:"Opacity slider",input:"Color value field",format:"Color format",swatch:"Color swatch",instruction:"Saturation and brightness selector. Use up, down, left and right arrow keys to select."}},w={},T="",k={},P=!1;function E(n){if("object"==typeof n)for(var s in n)switch(s){case"el":M(n.el),!1!==n.wrap&&L(n.el);break;case"parent":(r=e.querySelector(n.parent))&&(r.appendChild(i),b.parent=n.parent,r===e.body&&(r=null));break;case"themeMode":b.themeMode=n.themeMode,"auto"===n.themeMode&&t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)").matches&&(b.themeMode="dark");case"theme":n.theme&&(b.theme=n.theme),i.className="clr-picker clr-"+b.theme+" clr-"+b.themeMode,b.inline&&R();break;case"margin":n.margin*=1,b.margin=isNaN(n.margin)?b.margin:n.margin;break;case"wrap":n.el&&n.wrap&&L(n.el);break;case"formatToggle":b.formatToggle=!!n.formatToggle,J("clr-format").style.display=b.formatToggle?"block":"none",b.formatToggle&&(b.format="auto");break;case"swatches":Array.isArray(n.swatches)&&function(){var t=[];n.swatches.forEach((function(e,n){t.push('<button type="button" id="clr-swatch-'+n+'" aria-labelledby="clr-swatch-label clr-swatch-'+n+'" style="color: '+e+';">'+e+"</button>")})),J("clr-swatches").innerHTML=t.length?"<div>"+t.join("")+"</div>":"",b.swatches=n.swatches.slice()}();break;case"swatchesOnly":b.swatchesOnly=!!n.swatchesOnly,i.setAttribute("data-minimal",b.swatchesOnly);break;case"alpha":b.alpha=!!n.alpha,i.setAttribute("data-alpha",b.alpha);break;case"inline":if(b.inline=!!n.inline,i.setAttribute("data-inline",b.inline),b.inline){var a=n.defaultColor||b.defaultColor;g=_(a),R(),V(a)}break;case"clearButton":"object"==typeof n.clearButton&&(n.clearButton.label&&(b.clearLabel=n.clearButton.label,h.innerHTML=b.clearLabel),n.clearButton=n.clearButton.show),b.clearButton=!!n.clearButton,h.style.display=b.clearButton?"block":"none";break;case"clearLabel":b.clearLabel=n.clearLabel,h.innerHTML=b.clearLabel;break;case"a11y":var u=n.a11y,f=!1;if("object"==typeof u)for(var m in u)u[m]&&b.a11y[m]&&(b.a11y[m]=u[m],f=!0);if(f){var v=J("clr-open-label"),y=J("clr-swatch-label");v.innerHTML=b.a11y.open,y.innerHTML=b.a11y.swatch,l.setAttribute("aria-label",b.a11y.close),d.setAttribute("aria-label",b.a11y.hueSlider),p.setAttribute("aria-label",b.a11y.alphaSlider),c.setAttribute("aria-label",b.a11y.input),o.setAttribute("aria-label",b.a11y.instruction)}default:b[s]=n[s]}}function C(t,e){"string"==typeof t&&"object"==typeof e&&(w[t]=e,P=!0)}function z(t){delete w[t],0===Object.keys(w).length&&(P=!1,t===T&&B())}function S(t){if(P){var e=["el","wrap","inline","defaultColor","a11y"],n=function(n){var r=w[n];if(t.matches(n)){for(var i in T=n,k={},e.forEach((function(t){return delete r[t]})),r)k[i]=Array.isArray(b[i])?b[i].slice():b[i];return E(r),"break"}};for(var r in w)if("break"===n(r))break}}function B(){Object.keys(k).length>0&&(E(k),T="",k={})}function M(t){tt(e,"click",t,(function(t){b.inline||(S(t.target),m=t.target,v=m.value,g=_(v),i.classList.add("clr-open"),R(),V(v),(b.focusInput||b.selectInput)&&c.focus({preventScroll:!0}),b.selectInput&&c.select(),m.dispatchEvent(new Event("open",{bubbles:!0})))})),tt(e,"input",t,(function(t){var e=t.target.parentNode;e.classList.contains("clr-field")&&(e.style.color=t.target.value)}))}function R(){var n,a,l,c=r,h=t.scrollY,d=i.offsetWidth,u=i.offsetHeight,p={left:!1,top:!1},f={x:0,y:0};if(c&&(n=t.getComputedStyle(c),a=parseFloat(n.marginTop),l=parseFloat(n.borderTopWidth),(f=c.getBoundingClientRect()).y+=l+h),!b.inline){var g=m.getBoundingClientRect(),v=g.x,y=h+g.y+g.height+b.margin;c?(v-=f.x,y-=f.y,v+d>c.clientWidth&&(v+=g.width-d,p.left=!0),y+u>c.clientHeight-a&&(y-=g.height+u+2*b.margin,p.top=!0),y+=c.scrollTop):(v+d>e.documentElement.clientWidth&&(v+=g.width-d,p.left=!0),y+u-h>e.documentElement.clientHeight&&(y=h+g.y-u-b.margin,p.top=!0)),i.classList.toggle("clr-left",p.left),i.classList.toggle("clr-top",p.top),i.style.left=v+"px",i.style.top=y+"px"}s={width:o.offsetWidth,height:o.offsetHeight,x:i.offsetLeft+o.offsetLeft+f.x,y:i.offsetTop+o.offsetTop+f.y}}function L(t){e.querySelectorAll(t).forEach((function(t){var n=t.parentNode;if(!n.classList.contains("clr-field")){var r=e.createElement("div");r.innerHTML='<button type="button" aria-labelledby="clr-open-label"></button>',n.insertBefore(r,t),r.setAttribute("class","clr-field"),r.style.color=t.value,r.appendChild(t)}}))}function I(t){m&&!b.inline&&(t&&v!==m.value&&(m.value=v,m.dispatchEvent(new Event("input",{bubbles:!0}))),v!==m.value&&m.dispatchEvent(new Event("change",{bubbles:!0})),i.classList.remove("clr-open"),P&&B(),m.dispatchEvent(new Event("close",{bubbles:!0})),b.focusInput&&m.focus({preventScroll:!0}),m=null)}function V(t){var e=Z(t),n=q(e);D(n.s,n.v),$(e,n),d.value=n.h,i.style.color="hsl("+n.h+", 100%, 50%)",u.style.left=n.h/360*100+"%",a.style.left=s.width*n.s/100+"px",a.style.top=s.height-s.height*n.v/100+"px",p.value=100*n.a,f.style.left=100*n.a+"%"}function _(t){var e=t.substring(0,3).toLowerCase();return"rgb"===e||"hsl"===e?e:"hex"}function A(t){t=void 0!==t?t:c.value,m&&(m.value=t,m.dispatchEvent(new Event("input",{bubbles:!0}))),e.dispatchEvent(new CustomEvent("coloris:pick",{detail:{color:t}}))}function O(t,e){var n={h:1*d.value,s:t/s.width*100,v:100-e/s.height*100,a:p.value/100},r=W(n);D(n.s,n.v),$(r,n),A()}function D(t,e){var n=b.a11y.marker;t=1*t.toFixed(1),e=1*e.toFixed(1),n=(n=n.replace("{s}",t)).replace("{v}",e),a.setAttribute("aria-label",n)}function j(t){return{pageX:t.changedTouches?t.changedTouches[0].pageX:t.pageX,pageY:t.changedTouches?t.changedTouches[0].pageY:t.pageY}}function N(t){var e=j(t),n=e.pageX-s.x,i=e.pageY-s.y;r&&(i+=r.scrollTop),n=n<0?0:n>s.width?s.width:n,i=i<0?0:i>s.height?s.height:i,a.style.left=n+"px",a.style.top=i+"px",O(n,i),t.preventDefault(),t.stopPropagation()}function U(t,e){var n=1*a.style.left.replace("px","")+t,r=1*a.style.top.replace("px","")+e;a.style.left=n+"px",a.style.top=r+"px",O(n,r)}function $(t,n){void 0===t&&(t={}),void 0===n&&(n={});var r=b.format;for(var i in t)x[i]=t[i];for(var s in n)x[s]=n[s];var h=Q(x),d=h.substring(0,7);switch(a.style.color=d,f.parentNode.style.color=d,f.style.color=h,l.style.color=h,o.style.display="none",o.offsetHeight,o.style.display="",f.nextElementSibling.style.display="none",f.nextElementSibling.offsetHeight,f.nextElementSibling.style.display="","mixed"===r?r=1===x.a?"hex":"rgb":"auto"===r&&(r=g),r){case"hex":c.value=h;break;case"rgb":c.value=X(x);break;case"hsl":c.value=Y(H(x))}e.querySelector('.clr-format [value="'+r+'"]').checked=!0}function G(){var t=1*d.value,e=1*a.style.left.replace("px",""),n=1*a.style.top.replace("px","");i.style.color="hsl("+t+", 100%, 50%)",u.style.left=t/360*100+"%",O(e,n)}function F(){var t=p.value/100;f.style.left=100*t+"%",$({a:t}),A()}function W(t){var e=t.s/100,r=t.v/100,i=e*r,o=t.h/60,s=i*(1-n.abs(o%2-1)),a=r-i;i+=a,s+=a;var l=n.floor(o)%6,c=[i,s,a,a,s,i][l],h=[s,i,i,s,a,a][l],d=[a,a,s,i,i,s][l];return{r:n.round(255*c),g:n.round(255*h),b:n.round(255*d),a:t.a}}function H(t){var e,r=t.v/100,i=r*(1-t.s/100/2);return i>0&&i<1&&(e=n.round((r-i)/n.min(i,1-i)*100)),{h:t.h,s:e||0,l:n.round(100*i),a:t.a}}function q(t){var e=t.r/255,r=t.g/255,i=t.b/255,o=n.max(e,r,i),s=o-n.min(e,r,i),a=o,l=0,c=0;return s&&(o===e&&(l=(r-i)/s),o===r&&(l=2+(i-e)/s),o===i&&(l=4+(e-r)/s),o&&(c=s/o)),{h:(l=n.floor(60*l))<0?l+360:l,s:n.round(100*c),v:n.round(100*a),a:t.a}}function Z(t){var e,n,r=/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i;return y.fillStyle="#000",y.fillStyle=t,(e=r.exec(y.fillStyle))?(n={r:1*e[3],g:1*e[4],b:1*e[5],a:1*e[6]}).a=+n.a.toFixed(2):n={r:(e=y.fillStyle.replace("#","").match(/.{2}/g).map((function(t){return parseInt(t,16)})))[0],g:e[1],b:e[2],a:1},n}function Q(t){var e=t.r.toString(16),n=t.g.toString(16),r=t.b.toString(16),i="";if(t.r<16&&(e="0"+e),t.g<16&&(n="0"+n),t.b<16&&(r="0"+r),b.alpha&&(t.a<1||b.forceAlpha)){var o=255*t.a|0;i=o.toString(16),o<16&&(i="0"+i)}return"#"+e+n+r+i}function X(t){return!b.alpha||1===t.a&&!b.forceAlpha?"rgb("+t.r+", "+t.g+", "+t.b+")":"rgba("+t.r+", "+t.g+", "+t.b+", "+t.a+")"}function Y(t){return!b.alpha||1===t.a&&!b.forceAlpha?"hsl("+t.h+", "+t.s+"%, "+t.l+"%)":"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"}function K(){r=null,(i=e.createElement("div")).setAttribute("id","clr-picker"),i.className="clr-picker",i.innerHTML='<input id="clr-color-value" class="clr-color" type="text" value="" spellcheck="false" aria-label="'+b.a11y.input+'"><div id="clr-color-area" class="clr-gradient" role="application" aria-label="'+b.a11y.instruction+'"><div id="clr-color-marker" class="clr-marker" tabindex="0"></div></div><div class="clr-hue"><input id="clr-hue-slider" type="range" min="0" max="360" step="1" aria-label="'+b.a11y.hueSlider+'"><div id="clr-hue-marker"></div></div><div class="clr-alpha"><input id="clr-alpha-slider" type="range" min="0" max="100" step="1" aria-label="'+b.a11y.alphaSlider+'"><div id="clr-alpha-marker"></div><span></span></div><div id="clr-format" class="clr-format"><fieldset class="clr-segmented"><legend>'+b.a11y.format+'</legend><input id="clr-f1" type="radio" name="clr-format" value="hex"><label for="clr-f1">Hex</label><input id="clr-f2" type="radio" name="clr-format" value="rgb"><label for="clr-f2">RGB</label><input id="clr-f3" type="radio" name="clr-format" value="hsl"><label for="clr-f3">HSL</label><span></span></fieldset></div><div id="clr-swatches" class="clr-swatches"></div><button type="button" id="clr-clear" class="clr-clear">'+b.clearLabel+'</button><button type="button" id="clr-color-preview" class="clr-preview" aria-label="'+b.a11y.close+'"></button><span id="clr-open-label" hidden>'+b.a11y.open+'</span><span id="clr-swatch-label" hidden>'+b.a11y.swatch+"</span>",e.body.appendChild(i),o=J("clr-color-area"),a=J("clr-color-marker"),h=J("clr-clear"),l=J("clr-color-preview"),c=J("clr-color-value"),d=J("clr-hue-slider"),u=J("clr-hue-marker"),p=J("clr-alpha-slider"),f=J("clr-alpha-marker"),M(b.el),L(b.el),tt(i,"mousedown",(function(t){i.classList.remove("clr-keyboard-nav"),t.stopPropagation()})),tt(o,"mousedown",(function(t){tt(e,"mousemove",N)})),tt(o,"touchstart",(function(t){e.addEventListener("touchmove",N,{passive:!1})})),tt(a,"mousedown",(function(t){tt(e,"mousemove",N)})),tt(a,"touchstart",(function(t){e.addEventListener("touchmove",N,{passive:!1})})),tt(c,"change",(function(t){V(c.value),A()})),tt(h,"click",(function(t){A(""),I()})),tt(l,"click",(function(t){A(),I()})),tt(e,"click",".clr-format input",(function(t){g=t.target.value,$(),A()})),tt(i,"click",".clr-swatches button",(function(t){V(t.target.textContent),A(),b.swatchesOnly&&I()})),tt(e,"mouseup",(function(t){e.removeEventListener("mousemove",N)})),tt(e,"touchend",(function(t){e.removeEventListener("touchmove",N)})),tt(e,"mousedown",(function(t){i.classList.remove("clr-keyboard-nav"),I()})),tt(e,"keydown",(function(t){"Escape"===t.key?I(!0):"Tab"===t.key&&i.classList.add("clr-keyboard-nav")})),tt(e,"click",".clr-field button",(function(t){P&&B(),t.target.nextElementSibling.dispatchEvent(new Event("click",{bubbles:!0}))})),tt(a,"keydown",(function(t){var e={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};-1!==Object.keys(e).indexOf(t.key)&&(U.apply(void 0,e[t.key]),t.preventDefault())})),tt(o,"click",N),tt(d,"input",G),tt(p,"input",F)}function J(t){return e.getElementById(t)}function tt(t,e,n,r){var i=Element.prototype.matches||Element.prototype.msMatchesSelector;"string"==typeof n?t.addEventListener(e,(function(t){i.call(t.target,n)&&r.call(t.target,t)})):(r=n,t.addEventListener(e,r))}function et(t,n){n=void 0!==n?n:[],"loading"!==e.readyState?t.apply(void 0,n):e.addEventListener("DOMContentLoaded",(function(){t.apply(void 0,n)}))}void 0!==NodeList&&NodeList.prototype&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);var nt=function(){var t={init:K,set:E,wrap:L,close:I,setInstance:C,removeInstance:z,updatePosition:R};function e(t){et((function(){t&&("string"==typeof t?M(t):E(t))}))}var n=function(n){e[n]=function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];et(t[n],r)}};for(var r in t)n(r);return e}();return nt.coloris=nt,nt}(window,document,Math)},void 0===(i="function"==typeof n?n.apply(e,r):n)||(t.exports=i)},405:(e,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Bezier=void 0;const{abs:r,cos:i,sin:o,acos:s,atan2:a,sqrt:l,pow:c}=Math;function h(t){return t<0?-c(-t,1/3):c(t,1/3)}const d=Math.PI,u=2*d,p=d/2,f=Number.MAX_SAFE_INTEGER||9007199254740991,m=Number.MIN_SAFE_INTEGER||-9007199254740991,g={x:0,y:0,z:0},v={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){const n=e(t);let r=n.x*n.x+n.y*n.y;return void 0!==n.z&&(r+=n.z*n.z),l(r)},compute:function(t,e,n){if(0===t)return e[0].t=0,e[0];const r=e.length-1;if(1===t)return e[r].t=1,e[r];const i=1-t;let o=e;if(0===r)return e[0].t=t,e[0];if(1===r){const e={x:i*o[0].x+t*o[1].x,y:i*o[0].y+t*o[1].y,t};return n&&(e.z=i*o[0].z+t*o[1].z),e}if(r<4){let e,s,a,l=i*i,c=t*t,h=0;2===r?(o=[o[0],o[1],o[2],g],e=l,s=i*t*2,a=c):3===r&&(e=l*i,s=l*t*3,a=i*c*3,h=t*c);const d={x:e*o[0].x+s*o[1].x+a*o[2].x+h*o[3].x,y:e*o[0].y+s*o[1].y+a*o[2].y+h*o[3].y,t};return n&&(d.z=e*o[0].z+s*o[1].z+a*o[2].z+h*o[3].z),d}const s=JSON.parse(JSON.stringify(e));for(;s.length>1;){for(let e=0;e<s.length-1;e++)s[e]={x:s[e].x+(s[e+1].x-s[e].x)*t,y:s[e].y+(s[e+1].y-s[e].y)*t},void 0!==s[e].z&&(s[e]=s[e].z+(s[e+1].z-s[e].z)*t);s.splice(s.length-1,1)}return s[0].t=t,s[0]},computeWithRatios:function(t,e,n,r){const i=1-t,o=n,s=e;let a,l=o[0],c=o[1],h=o[2],d=o[3];return l*=i,c*=t,2===s.length?(a=l+c,{x:(l*s[0].x+c*s[1].x)/a,y:(l*s[0].y+c*s[1].y)/a,z:!!r&&(l*s[0].z+c*s[1].z)/a,t}):(l*=i,c*=2*i,h*=t*t,3===s.length?(a=l+c+h,{x:(l*s[0].x+c*s[1].x+h*s[2].x)/a,y:(l*s[0].y+c*s[1].y+h*s[2].y)/a,z:!!r&&(l*s[0].z+c*s[1].z+h*s[2].z)/a,t}):(l*=i,c*=1.5*i,h*=3*i,d*=t*t*t,4===s.length?(a=l+c+h+d,{x:(l*s[0].x+c*s[1].x+h*s[2].x+d*s[3].x)/a,y:(l*s[0].y+c*s[1].y+h*s[2].y+d*s[3].y)/a,z:!!r&&(l*s[0].z+c*s[1].z+h*s[2].z+d*s[3].z)/a,t}):void 0))},derive:function(t,e){const n=[];for(let r=t,i=r.length,o=i-1;i>1;i--,o--){const t=[];for(let n,i=0;i<o;i++)n={x:o*(r[i+1].x-r[i].x),y:o*(r[i+1].y-r[i].y)},e&&(n.z=o*(r[i+1].z-r[i].z)),t.push(n);n.push(t),r=t}return n},between:function(t,e,n){return e<=t&&t<=n||v.approximately(t,e)||v.approximately(t,n)},approximately:function(t,e,n){return r(t-e)<=(n||1e-6)},length:function(t){const e=v.Tvalues.length;let n=0;for(let r,i=0;i<e;i++)r=.5*v.Tvalues[i]+.5,n+=v.Cvalues[i]*v.arcfn(r,t);return.5*n},map:function(t,e,n,r,i){return r+(i-r)*((t-e)/(n-e))},lerp:function(t,e,n){const r={x:e.x+t*(n.x-e.x),y:e.y+t*(n.y-e.y)};return void 0!==e.z&&void 0!==n.z&&(r.z=e.z+t*(n.z-e.z)),r},pointToString:function(t){let e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(v.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,n){const r=e.x-t.x,i=e.y-t.y,o=n.x-t.x,s=n.y-t.y;return a(r*s-i*o,r*o+i*s)},round:function(t,e){const n=""+t,r=n.indexOf(".");return parseFloat(n.substring(0,r+1+e))},dist:function(t,e){const n=t.x-e.x,r=t.y-e.y;return l(n*n+r*r)},closest:function(t,e){let n,r,i=c(2,63);return t.forEach((function(t,o){r=v.dist(e,t),r<i&&(i=r,n=o)})),{mdist:i,mpos:n}},abcratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const n=c(t,e)+c(1-t,e);return r((n-1)/n)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const n=c(1-t,e);return n/(c(t,e)+n)},lli8:function(t,e,n,r,i,o,s,a){const l=(t-n)*(o-a)-(e-r)*(i-s);return 0!=l&&{x:((t*r-e*n)*(i-s)-(t-n)*(i*a-o*s))/l,y:((t*r-e*n)*(o-a)-(e-r)*(i*a-o*s))/l}},lli4:function(t,e,n,r){const i=t.x,o=t.y,s=e.x,a=e.y,l=n.x,c=n.y,h=r.x,d=r.y;return v.lli8(i,o,s,a,l,c,h,d)},lli:function(t,e){return v.lli4(t,t.c,e,e.c)},makeline:function(t,e){return new z(t.x,t.y,(t.x+e.x)/2,(t.y+e.y)/2,e.x,e.y)},findbbox:function(t){let e=f,n=f,r=m,i=m;return t.forEach((function(t){const o=t.bbox();e>o.x.min&&(e=o.x.min),n>o.y.min&&(n=o.y.min),r<o.x.max&&(r=o.x.max),i<o.y.max&&(i=o.y.max)})),{x:{min:e,mid:(e+r)/2,max:r,size:r-e},y:{min:n,mid:(n+i)/2,max:i,size:i-n}}},shapeintersections:function(t,e,n,r,i){if(!v.bboxoverlap(e,r))return[];const o=[],s=[t.startcap,t.forward,t.back,t.endcap],a=[n.startcap,n.forward,n.back,n.endcap];return s.forEach((function(e){e.virtual||a.forEach((function(r){if(r.virtual)return;const s=e.intersects(r,i);s.length>0&&(s.c1=e,s.c2=r,s.s1=t,s.s2=n,o.push(s))}))})),o},makeshape:function(t,e,n){const r=e.points.length,i=t.points.length,o=v.makeline(e.points[r-1],t.points[0]),s=v.makeline(t.points[i-1],e.points[0]),a={startcap:o,forward:t,back:e,endcap:s,bbox:v.findbbox([o,t,e,s]),intersections:function(t){return v.shapeintersections(a,a.bbox,t,t.bbox,n)}};return a},getminmax:function(t,e,n){if(!n)return{min:0,max:0};let r,i,o=f,s=m;-1===n.indexOf(0)&&(n=[0].concat(n)),-1===n.indexOf(1)&&n.push(1);for(let a=0,l=n.length;a<l;a++)r=n[a],i=t.get(r),i[e]<o&&(o=i[e]),i[e]>s&&(s=i[e]);return{min:o,mid:(o+s)/2,max:s,size:s-o}},align:function(t,e){const n=e.p1.x,r=e.p1.y,s=-a(e.p2.y-r,e.p2.x-n);return t.map((function(t){return{x:(t.x-n)*i(s)-(t.y-r)*o(s),y:(t.x-n)*o(s)+(t.y-r)*i(s)}}))},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const n=t.length-1,r=v.align(t,e),o=function(t){return 0<=t&&t<=1};if(2===n){const t=r[0].y,e=r[1].y,n=r[2].y,i=t-2*e+n;if(0!==i){const r=-l(e*e-t*n),s=-t+e;return[-(r+s)/i,-(-r+s)/i].filter(o)}return e!==n&&0===i?[(2*e-n)/(2*e-2*n)].filter(o):[]}const a=r[0].y,c=r[1].y,d=r[2].y;let p=3*c-a-3*d+r[3].y,f=3*a-6*c+3*d,m=-3*a+3*c,g=a;if(v.approximately(p,0)){if(v.approximately(f,0))return v.approximately(m,0)?[]:[-g/m].filter(o);const t=l(m*m-4*f*g),e=2*f;return[(t-m)/e,(-m-t)/e].filter(o)}f/=p,m/=p,g/=p;const y=(3*m-f*f)/3,x=y/3,b=(2*f*f*f-9*f*m+27*g)/27,w=b/2,T=w*w+x*x*x;let k,P,E,C,z;if(T<0){const t=-y/3,e=l(t*t*t),n=-b/(2*e),r=s(n<-1?-1:n>1?1:n),a=2*h(e);return E=a*i(r/3)-f/3,C=a*i((r+u)/3)-f/3,z=a*i((r+2*u)/3)-f/3,[E,C,z].filter(o)}if(0===T)return k=w<0?h(-w):-h(w),E=2*k-f/3,C=-k-f/3,[E,C].filter(o);{const t=l(T);return k=h(-w+t),P=h(w+t),[k-P-f/3].filter(o)}},droots:function(t){if(3===t.length){const e=t[0],n=t[1],r=t[2],i=e-2*n+r;if(0!==i){const t=-l(n*n-e*r),o=-e+n;return[-(t+o)/i,-(-t+o)/i]}return n!==r&&0===i?[(2*n-r)/(2*(n-r))]:[]}if(2===t.length){const e=t[0],n=t[1];return e!==n?[e/(e-n)]:[]}return[]},curvature:function(t,e,n,i,o){let s,a,h,d,u=0,p=0;const f=v.compute(t,e),m=v.compute(t,n),g=f.x*f.x+f.y*f.y;if(i?(s=l(c(f.y*m.z-m.y*f.z,2)+c(f.z*m.x-m.z*f.x,2)+c(f.x*m.y-m.x*f.y,2)),a=c(g+f.z*f.z,1.5)):(s=f.x*m.y-f.y*m.x,a=c(g,1.5)),0===s||0===a)return{k:0,r:0};if(u=s/a,p=a/s,!o){const o=v.curvature(t-.001,e,n,i,!0).k,s=v.curvature(t+.001,e,n,i,!0).k;d=(s-u+(u-o))/2,h=(r(s-u)+r(u-o))/2}return{k:u,r:p,dk:d,adk:h}},inflections:function(t){if(t.length<4)return[];const e=v.align(t,{p1:t[0],p2:t.slice(-1)[0]}),n=e[2].x*e[1].y,r=e[3].x*e[1].y,i=e[1].x*e[2].y,o=18*(-3*n+2*r+3*i-e[3].x*e[2].y),s=18*(3*n-r-3*i),a=18*(i-n);if(v.approximately(o,0)){if(!v.approximately(s,0)){let t=-a/s;if(0<=t&&t<=1)return[t]}return[]}const l=s*s-4*o*a,c=Math.sqrt(l),h=2*o;return v.approximately(h,0)?[]:[(c-s)/h,-(s+c)/h].filter((function(t){return 0<=t&&t<=1}))},bboxoverlap:function(t,e){const n=["x","y"],i=n.length;for(let o,s,a,l,c=0;c<i;c++)if(o=n[c],s=t[o].mid,a=e[o].mid,l=(t[o].size+e[o].size)/2,r(s-a)>=l)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,n){const r=t.bbox(),i=e.bbox(),o=1e5,s=n||.5;if(r.x.size+r.y.size<s&&i.x.size+i.y.size<s)return[(o*(t._t1+t._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let a=t.split(.5),l=e.split(.5),c=[{left:a.left,right:l.left},{left:a.left,right:l.right},{left:a.right,right:l.right},{left:a.right,right:l.left}];c=c.filter((function(t){return v.bboxoverlap(t.left.bbox(),t.right.bbox())}));let h=[];return 0===c.length||(c.forEach((function(t){h=h.concat(v.pairiteration(t.left,t.right,s))})),h=h.filter((function(t,e){return h.indexOf(t)===e}))),h},getccenter:function(t,e,n){const r=e.x-t.x,s=e.y-t.y,l=n.x-e.x,c=n.y-e.y,h=r*i(p)-s*o(p),d=r*o(p)+s*i(p),f=l*i(p)-c*o(p),m=l*o(p)+c*i(p),g=(t.x+e.x)/2,y=(t.y+e.y)/2,x=(e.x+n.x)/2,b=(e.y+n.y)/2,w=g+h,T=y+d,k=x+f,P=b+m,E=v.lli8(g,y,w,T,x,b,k,P),C=v.dist(E,t);let z,S=a(t.y-E.y,t.x-E.x),B=a(e.y-E.y,e.x-E.x),M=a(n.y-E.y,n.x-E.x);return S<M?((S>B||B>M)&&(S+=u),S>M&&(z=M,M=S,S=z)):M<B&&B<S?(z=M,M=S,S=z):M+=u,E.s=S,E.e=M,E.r=C,E},numberSort:function(t,e){return t-e}};class y{constructor(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(t){return v.pointsToString(t.points)})).join(", ")+"]"}addCurve(t){this.curves.push(t),this._3d=this._3d||t._3d}length(){return this.curves.map((function(t){return t.length()})).reduce((function(t,e){return t+e}))}curve(t){return this.curves[t]}bbox(){const t=this.curves;for(var e=t[0].bbox(),n=1;n<t.length;n++)v.expandbox(e,t[n].bbox());return e}offset(t){const e=[];return this.curves.forEach((function(n){e.push(...n.offset(t))})),new y(e)}}const{abs:x,min:b,max:w,cos:T,sin:k,acos:P,sqrt:E}=Math,C=Math.PI;class z{constructor(t){let e=t&&t.forEach?t:Array.from(arguments).slice(),n=!1;if("object"==typeof e[0]){n=e.length;const t=[];e.forEach((function(e){["x","y","z"].forEach((function(n){void 0!==e[n]&&t.push(e[n])}))})),e=t}let r=!1;const i=e.length;if(n){if(n>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");r=!0}}else if(6!==i&&8!==i&&9!==i&&12!==i&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!r&&(9===i||12===i)||t&&t[0]&&void 0!==t[0].z,s=this.points=[];for(let t=0,n=o?3:2;t<i;t+=n){var a={x:e[t],y:e[t+1]};o&&(a.z=e[t+2]),s.push(a)}const l=this.order=s.length-1,c=this.dims=["x","y"];o&&c.push("z"),this.dimlen=c.length;const h=v.align(s,{p1:s[0],p2:s[l]}),d=v.dist(s[0],s[l]);this._linear=h.reduce(((t,e)=>t+x(e.y)),0)<d/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(t,e,n,r){if(void 0===r&&(r=.5),0===r)return new z(e,e,n);if(1===r)return new z(t,e,e);const i=z.getABC(2,t,e,n,r);return new z(t,i.A,n)}static cubicFromPoints(t,e,n,r,i){void 0===r&&(r=.5);const o=z.getABC(3,t,e,n,r);void 0===i&&(i=v.dist(e,o.C));const s=i*(1-r)/r,a=v.dist(t,n),l=(n.x-t.x)/a,c=(n.y-t.y)/a,h=i*l,d=i*c,u=s*l,p=s*c,f=e.x-h,m=e.y-d,g=e.x+u,y=e.y+p,x=o.A,b=x.x+(f-x.x)/(1-r),w=x.y+(m-x.y)/(1-r),T=x.x+(g-x.x)/r,k=x.y+(y-x.y)/r,P={x:t.x+(b-t.x)/r,y:t.y+(w-t.y)/r},E={x:n.x+(T-n.x)/(1-r),y:n.y+(k-n.y)/(1-r)};return new z(t,P,E,n)}static getUtils(){return v}getUtils(){return z.getUtils()}static get PolyBezier(){return y}valueOf(){return this.toString()}toString(){return v.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const t=this.points,e=["M",t[0].x,t[0].y,2===this.order?"Q":"C"];for(let n=1,r=t.length;n<r;n++)e.push(t[n].x),e.push(t[n].y);return e.join(" ")}setRatios(t){if(t.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=t,this._lut=[]}verify(){const t=this.coordDigest();t!==this._print&&(this._print=t,this.update())}coordDigest(){return this.points.map((function(t,e){return""+e+t.x+t.y+(t.z?t.z:0)})).join("")}update(){this._lut=[],this.dpoints=v.derive(this.points,this._3d),this.computedirection()}computedirection(){const t=this.points,e=v.angle(t[0],t[this.order],t[1]);this.clockwise=e>0}length(){return v.length(this.derivative.bind(this))}static getABC(t=2,e,n,r,i=.5){const o=v.projectionratio(i,t),s=1-o,a={x:o*e.x+s*r.x,y:o*e.y+s*r.y},l=v.abcratio(i,t);return{A:{x:n.x+(n.x-a.x)/l,y:n.y+(n.y-a.y)/l},B:n,C:a,S:e,E:r}}getABC(t,e){e=e||this.get(t);let n=this.points[0],r=this.points[this.order];return z.getABC(this.order,n,e,r,t)}getLUT(t){if(this.verify(),t=t||100,this._lut.length===t)return this._lut;this._lut=[],t++,this._lut=[];for(let e,n,r=0;r<t;r++)n=r/(t-1),e=this.compute(n),e.t=n,this._lut.push(e);return this._lut}on(e,n){n=n||5;const r=this.getLUT(),i=[];for(let t,o=0,s=0;o<r.length;o++)t=r[o],v.dist(t,e)<n&&(i.push(t),s+=o/r.length);return!!i.length&&(t/=i.length)}project(t){const e=this.getLUT(),n=e.length-1,r=v.closest(e,t),i=r.mpos,o=(i-1)/n,s=(i+1)/n,a=.1/n;let l,c,h=r.mdist,d=o,u=d;for(h+=1;d<s+a;d+=a)l=this.compute(d),c=v.dist(t,l),c<h&&(h=c,u=d);return u=u<0?0:u>1?1:u,l=this.compute(u),l.t=u,l.d=h,l}get(t){return this.compute(t)}point(t){return this.points[t]}compute(t){return this.ratios?v.computeWithRatios(t,this.points,this.ratios,this._3d):v.compute(t,this.points,this._3d,this.ratios)}raise(){const t=this.points,e=[t[0]],n=t.length;for(let r,i,o=1;o<n;o++)r=t[o],i=t[o-1],e[o]={x:(n-o)/n*r.x+o/n*i.x,y:(n-o)/n*r.y+o/n*i.y};return e[n]=t[n-1],new z(e)}derivative(t){return v.compute(t,this.dpoints[0],this._3d)}dderivative(t){return v.compute(t,this.dpoints[1],this._3d)}align(){let t=this.points;return new z(v.align(t,{p1:t[0],p2:t[t.length-1]}))}curvature(t){return v.curvature(t,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return v.inflections(this.points)}normal(t){return this._3d?this.__normal3(t):this.__normal2(t)}__normal2(t){const e=this.derivative(t),n=E(e.x*e.x+e.y*e.y);return{x:-e.y/n,y:e.x/n}}__normal3(t){const e=this.derivative(t),n=this.derivative(t+.01),r=E(e.x*e.x+e.y*e.y+e.z*e.z),i=E(n.x*n.x+n.y*n.y+n.z*n.z);e.x/=r,e.y/=r,e.z/=r,n.x/=i,n.y/=i,n.z/=i;const o={x:n.y*e.z-n.z*e.y,y:n.z*e.x-n.x*e.z,z:n.x*e.y-n.y*e.x},s=E(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=s,o.y/=s,o.z/=s;const a=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{x:a[0]*e.x+a[1]*e.y+a[2]*e.z,y:a[3]*e.x+a[4]*e.y+a[5]*e.z,z:a[6]*e.x+a[7]*e.y+a[8]*e.z}}hull(t){let e=this.points,n=[],r=[],i=0;for(r[i++]=e[0],r[i++]=e[1],r[i++]=e[2],3===this.order&&(r[i++]=e[3]);e.length>1;){n=[];for(let o,s=0,a=e.length-1;s<a;s++)o=v.lerp(t,e[s],e[s+1]),r[i++]=o,n.push(o);e=n}return r}split(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;const n=this.hull(t),r={left:2===this.order?new z([n[0],n[3],n[5]]):new z([n[0],n[4],n[7],n[9]]),right:2===this.order?new z([n[5],n[4],n[2]]):new z([n[9],n[8],n[6],n[3]]),span:n};return r.left._t1=v.map(0,0,1,this._t1,this._t2),r.left._t2=v.map(t,0,1,this._t1,this._t2),r.right._t1=v.map(t,0,1,this._t1,this._t2),r.right._t2=v.map(1,0,1,this._t1,this._t2),e?(e=v.map(e,t,1,0,1),r.right.split(e).left):r}extrema(){const t={};let e=[];return this.dims.forEach(function(n){let r=function(t){return t[n]},i=this.dpoints[0].map(r);t[n]=v.droots(i),3===this.order&&(i=this.dpoints[1].map(r),t[n]=t[n].concat(v.droots(i))),t[n]=t[n].filter((function(t){return t>=0&&t<=1})),e=e.concat(t[n].sort(v.numberSort))}.bind(this)),t.values=e.sort(v.numberSort).filter((function(t,n){return e.indexOf(t)===n})),t}bbox(){const t=this.extrema(),e={};return this.dims.forEach(function(n){e[n]=v.getminmax(this,n,t[n])}.bind(this)),e}overlaps(t){const e=this.bbox(),n=t.bbox();return v.bboxoverlap(e,n)}offset(t,e){if(void 0!==e){const n=this.get(t),r=this.normal(t),i={c:n,n:r,x:n.x+r.x*e,y:n.y+r.y*e};return this._3d&&(i.z=n.z+r.z*e),i}if(this._linear){const e=this.normal(0),n=this.points.map((function(n){const r={x:n.x+t*e.x,y:n.y+t*e.y};return n.z&&e.z&&(r.z=n.z+t*e.z),r}));return[new z(n)]}return this.reduce().map((function(e){return e._linear?e.offset(t)[0]:e.scale(t)}))}simple(){if(3===this.order){const t=v.angle(this.points[0],this.points[3],this.points[1]),e=v.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&e<0||t<0&&e>0)return!1}const t=this.normal(0),e=this.normal(1);let n=t.x*e.x+t.y*e.y;return this._3d&&(n+=t.z*e.z),x(P(n))<C/3}reduce(){let t,e,n=0,r=0,i=.01,o=[],s=[],a=this.extrema().values;for(-1===a.indexOf(0)&&(a=[0].concat(a)),-1===a.indexOf(1)&&a.push(1),n=a[0],t=1;t<a.length;t++)r=a[t],e=this.split(n,r),e._t1=n,e._t2=r,o.push(e),n=r;return o.forEach((function(t){for(n=0,r=0;r<=1;)for(r=n+i;r<=1.01;r+=i)if(e=t.split(n,r),!e.simple()){if(r-=i,x(n-r)<i)return[];e=t.split(n,r),e._t1=v.map(n,0,1,t._t1,t._t2),e._t2=v.map(r,0,1,t._t1,t._t2),s.push(e),n=r;break}n<1&&(e=t.split(n,1),e._t1=v.map(n,0,1,t._t1,t._t2),e._t2=t._t2,s.push(e))})),s}translate(t,e,n){n="number"==typeof n?n:e;const r=this.order;let i=this.points.map(((t,i)=>(1-i/r)*e+i/r*n));return new z(this.points.map(((e,n)=>({x:e.x+t.x*i[n],y:e.y+t.y*i[n]}))))}scale(t){const e=this.order;let n=!1;if("function"==typeof t&&(n=t),n&&2===e)return this.raise().scale(n);const r=this.clockwise,i=this.points;if(this._linear)return this.translate(this.normal(0),n?n(0):t,n?n(1):t);const o=n?n(0):t,s=n?n(1):t,a=[this.offset(0,10),this.offset(1,10)],l=[],c=v.lli4(a[0],a[0].c,a[1],a[1].c);if(!c)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(t){const n=l[t*e]=v.copy(i[t*e]);n.x+=(t?s:o)*a[t].n.x,n.y+=(t?s:o)*a[t].n.y})),n?([0,1].forEach((function(o){if(2!==e||!o){var s=i[o+1],a={x:s.x-c.x,y:s.y-c.y},h=n?n((o+1)/e):t;n&&!r&&(h=-h);var d=E(a.x*a.x+a.y*a.y);a.x/=d,a.y/=d,l[o+1]={x:s.x+h*a.x,y:s.y+h*a.y}}})),new z(l)):([0,1].forEach((t=>{if(2===e&&t)return;const n=l[t*e],r=this.derivative(t),o={x:n.x+r.x,y:n.y+r.y};l[t+1]=v.lli4(n,o,c,i[t+1])})),new z(l))}outline(t,e,n,r){if(e=void 0===e?t:e,this._linear){const i=this.normal(0),o=this.points[0],s=this.points[this.points.length-1];let a,l,c;void 0===n&&(n=t,r=e),a={x:o.x+i.x*t,y:o.y+i.y*t},c={x:s.x+i.x*n,y:s.y+i.y*n},l={x:(a.x+c.x)/2,y:(a.y+c.y)/2};const h=[a,l,c];a={x:o.x-i.x*e,y:o.y-i.y*e},c={x:s.x-i.x*r,y:s.y-i.y*r},l={x:(a.x+c.x)/2,y:(a.y+c.y)/2};const d=[c,l,a],u=v.makeline(d[2],h[0]),p=v.makeline(h[2],d[0]),f=[u,new z(h),p,new z(d)];return new y(f)}const i=this.reduce(),o=i.length,s=[];let a,l=[],c=0,h=this.length();const d=void 0!==n&&void 0!==r;function u(t,e,n,r,i){return function(o){const s=r/n,a=(r+i)/n,l=e-t;return v.map(o,0,1,t+s*l,t+a*l)}}i.forEach((function(i){const o=i.length();d?(s.push(i.scale(u(t,n,h,c,o))),l.push(i.scale(u(-e,-r,h,c,o)))):(s.push(i.scale(t)),l.push(i.scale(-e))),c+=o})),l=l.map((function(t){return a=t.points,a[3]?t.points=[a[3],a[2],a[1],a[0]]:t.points=[a[2],a[1],a[0]],t})).reverse();const p=s[0].points[0],f=s[o-1].points[s[o-1].points.length-1],m=l[o-1].points[l[o-1].points.length-1],g=l[0].points[0],x=v.makeline(m,p),b=v.makeline(f,g),w=[x].concat(s).concat([b]).concat(l);return new y(w)}outlineshapes(t,e,n){e=e||t;const r=this.outline(t,e).curves,i=[];for(let t=1,e=r.length;t<e/2;t++){const o=v.makeshape(r[t],r[e-t],n);o.startcap.virtual=t>1,o.endcap.virtual=t<e/2-1,i.push(o)}return i}intersects(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof z&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)}lineIntersects(t){const e=b(t.p1.x,t.p2.x),n=b(t.p1.y,t.p2.y),r=w(t.p1.x,t.p2.x),i=w(t.p1.y,t.p2.y);return v.roots(this.points,t).filter((t=>{var o=this.get(t);return v.between(o.x,e,r)&&v.between(o.y,n,i)}))}selfintersects(t){const e=this.reduce(),n=e.length-2,r=[];for(let i,o,s,a=0;a<n;a++)o=e.slice(a,a+1),s=e.slice(a+2),i=this.curveintersects(o,s,t),r.push(...i);return r}curveintersects(t,e,n){const r=[];t.forEach((function(t){e.forEach((function(e){t.overlaps(e)&&r.push({left:t,right:e})}))}));let i=[];return r.forEach((function(t){const e=v.pairiteration(t.left,t.right,n);e.length>0&&(i=i.concat(e))})),i}arcs(t){return t=t||.5,this._iterate(t,[])}_error(t,e,n,r){const i=(r-n)/4,o=this.get(n+i),s=this.get(r-i),a=v.dist(t,e),l=v.dist(t,o),c=v.dist(t,s);return x(l-a)+x(c-a)}_iterate(t,e){let n,r=0,i=1;do{n=0,i=1;let o,s,a,l,c,h=this.get(r),d=!1,u=!1,p=i,f=1;do{if(u=d,l=a,p=(r+i)/2,o=this.get(p),s=this.get(i),a=v.getccenter(h,o,s),a.interval={start:r,end:i},d=this._error(a,h,r,i)<=t,c=u&&!d,c||(f=i),d){if(i>=1){if(a.interval.end=f=1,l=a,i>1){let t={x:a.x+a.r*T(a.e),y:a.y+a.r*k(a.e)};a.e+=v.angle({x:a.x,y:a.y},t,this.get(1))}break}i+=(i-r)/2}else i=p}while(!c&&n++<100);if(n>=100)break;l=l||a,e.push(l),r=f}while(i<1);return e}}n.Bezier=z}},n={};function r(t){var i=n[t];if(void 0!==i)return i.exports;var o=n[t]={id:t,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nc=void 0;var i=r(650);window.svgEditorBundle=i})();